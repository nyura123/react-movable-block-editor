(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{249:function(e,t,n){e.exports=n(689)},254:function(e,t,n){},255:function(e,t,n){},507:function(e,t,n){},689:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(19),i=n.n(o),d=(n(254),n(3)),l=n(105),c=(n(255),n(691)),u=n(41),s=n(26),h=n(44),f=n(42),p=n(43),v=n(66),g=n(38),b=n(1),m=n.n(b),y=n(230),I=(n(231),n(232));function w(e,t){return Object(d.a)({},e,Object(g.a)({},t.id,t))}function C(e,t){var n=e[t];if(!n)return e;if(n&&n.parentId){var r=e[n.parentId];if(r)if(r.childrenIds.findIndex(function(e){return e===n.id})>=0){var a=r.childrenIds.filter(function(e){return e!==n.id});e=w(e,Object(d.a)({},r,{childrenIds:a}))}}return Object(d.a)({},e,Object(g.a)({},t,void 0))}function k(e,t,n,r){if(!t)return e;if(function e(t,n,r){var a=t[n];if(!a)return!1;if(a.childrenIds.indexOf(r)>=0)return!0;var o=!0,i=!1,d=void 0;try{for(var l,c=a.childrenIds[Symbol.iterator]();!(o=(l=c.next()).done);o=!0)if(e(t,l.value,r))return!1}catch(u){i=!0,d=u}finally{try{o||null==c.return||c.return()}finally{if(i)throw d}}return!1}(e,t.id,n))return console.warn("node ",t.id," has ",n," as child, so cannot make it into",t.id,"'s parent"),e;if(t.id===n)return console.warn("Cannot place into self: ",{id:t.id,newParentId:n}),e;if(t&&t.parentId&&t.parentId!==n){var a=e[t.parentId];if(a){var o=a.childrenIds.filter(function(e){return e!==t.id});e=w(e,Object(d.a)({},a,{childrenIds:o}))}}var i=e[n];if(i){var l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t===n.beforeItemId||t===n.afterItemId)return console.warn("Cannot place relative to self: ",Object(d.a)({itemId:t},n)),e;e=e.filter(function(e){return e!==t});var r=n.beforeItemId,a=n.afterItemId,o=-1;if(r?o=e.findIndex(function(e){return e===r}):a&&(o=e.findIndex(function(e){return e===a})+1),o>=0){var i=Object(v.a)(e);return i.splice(o,0,t),i}return[].concat(Object(v.a)(e),[t])}(i.childrenIds,t.id,r);e=w(e,Object(d.a)({},i,{childrenIds:l}))}return w(e,Object(d.a)({},t,{parentId:n}))}var O=n(688).cloneDeep;function E(e,t){return t?Object(d.a)({},t,{value:O(t.value),childrenIds:Object(v.a)(t.childrenIds),children:t.childrenIds.map(function(t){return E(e,e[t])})}):t}function j(e){var t=e.byId,n=(e||{copiedNode:null}).copiedNode;if(!n)return e;var r=function e(t,n){n.id=N(t,n.type);var r=n.children;if(n.children=void 0,t=Object(d.a)({},t,Object(g.a)({},n.id,n)),r){var a=0,o=!0,i=!1,l=void 0;try{for(var c,u=r[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var s=c.value;s.parentId=n.id;var h=e(t,s),f=h.byId,p=h.newId;n.childrenIds[a]=p,t=f,++a}}catch(v){i=!0,l=v}finally{try{o||null==u.return||u.return()}finally{if(i)throw l}}}return{byId:t,newId:n.id}}(t,n=O(n)).byId;if(n.parentId){var a=t[n.parentId];if(a)return Object(d.a)({},e,{byId:k(r,n,n.parentId,{afterItemId:a.childrenIds[a.childrenIds.length-1]})})}return e}function N(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"node",n=Object.keys(e).length;e[n];)n++;return t+"_"+n}function x(e,t,n){var r=e.byId,a=Object(d.a)({},r[t],n);return Object(d.a)({},e,{byId:w(r,a)})}function B(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!n)return e;var a=e.byId,o=a[t];return Object(d.a)({},e,{byId:k(a,Object(d.a)({},o,{isPlaceHolder:r.isPlaceHolder},r.absolutePos?{top:r.absolutePos.top,left:r.absolutePos.left}:{}),n,r)})}function D(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t)return e;var r=e.focusedNodeId;return Object(d.a)({},e,{focusedNodeId:n?t.id:r===t.id?null:r})}function P(e){var t=e.filter(function(e){return 0===e.indexOf("draggednodeid:")}),n=e.filter(function(e){return 0===e.indexOf("draggednodetype:")});return 1!==t.length||1!==n.length?{draggedNodeId:"notanode",draggedNodeType:null}:{draggedNodeId:t[0].slice("draggednodeid:".length),draggedNodeType:n[0].slice("draggednodetype:".length)}}function R(e,t){return t?{left:e.clientX-t.left,top:e.clientY-t.top,width:t.width,height:t.height}:null}function T(e,t,n){e.stopPropagation();var r=R(e,n());r&&e.dataTransfer.setData("text/plain",JSON.stringify({startLeft:r.left,startTop:r.top})),e.dataTransfer.setData("draggednodeid:".concat(t.id),""),e.dataTransfer.setData("draggednodetype:".concat(t.type),"")}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return B(arguments.length>3?arguments[3]:void 0,P(e).draggedNodeId,t,n)}var M=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(f.a)(t).apply(this,arguments))).selfRef=null,e.getBoundingRect=function(){return e.selfRef&&e.selfRef.getBoundingClientRect?e.selfRef.getBoundingClientRect():null},e.canDrop=function(e){var t=P(e).draggedNodeType;return"row"===t||"col"===t||"markdown"===t||"image"===t||"layer"===t||"custom"===t},e.onDrop=function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.canDrop(t.dataTransfer.types)&&(t.stopPropagation(),P(t.dataTransfer.types).draggedNodeId)){var n=R(t,e.getBoundingRect()),r=e.props.node.childrenIds.length?e.props.node.childrenIds[e.props.node.childrenIds.length-1]:void 0,a=JSON.parse(t.dataTransfer.getData("text/plain"));e.props.onChange(S(t.dataTransfer.types,e.props.node.id,n?{afterItemId:r,absolutePos:{top:n.top-a.startTop,left:n.left-a.startLeft}}:void 0,e.props.value))}},e.onDragEnter=function(e){e.preventDefault()},e.onDragOver=function(t){e.canDrop(t.dataTransfer.types)&&(t.preventDefault(),t.stopPropagation())},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"renderChild",value:function(e){var t=this.props,n=t.value,r=t.onChange,a=t.renderEditBlock;return a({node:n.byId[e],renderEditBlock:a,value:n,onChange:r})}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,r=t.value.byId,a=n.childrenIds;return Object(b.createElement)("div",{ref:function(t){return e.selfRef=t},onDragOver:this.onDragOver,onDrop:this.onDrop,draggable:!0,onDragStart:function(t){return T(t,e.props.node,e.getBoundingRect)},style:{position:"relative",width:n.width,height:n.height,backgroundColor:n.backgroundColor||"#f5f5f5a3",borderRadius:3}},a.map(function(t){var n=r[t];return Object(b.createElement)("div",{key:"node_"+t,style:{position:"absolute",width:n.width,height:n.height,top:n.top,left:n.left}},e.renderChild(t))}))}}]),t}(b.Component),L=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(f.a)(t).apply(this,arguments))).selfRef=null,e.state={wantToPlaceNext:null},e.getBoundingRect=function(){return e.selfRef&&e.selfRef.getBoundingClientRect?e.selfRef.getBoundingClientRect():null},e.canDrop=function(e){var t=P(e).draggedNodeType;return"col"===t||"row"===t||"markdown"===t||"image"===t||"layer"===t||"custom"===t},e.shouldPlaceBefore=function(t,n){var r=R(t,e.getBoundingRect());return r&&("y"===n?r.top/r.height<.45:r.left/r.width<.45)},e.onDrop=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.canDrop(t.dataTransfer.types)){t.stopPropagation(),n||null===e.state.wantToPlaceNext||e.setState({wantToPlaceNext:null});var r=P(t.dataTransfer.types),a=r.draggedNodeId,o=r.draggedNodeType;if(a)if("col"===o){var i=e.shouldPlaceBefore(t,"x")?{beforeItemId:e.props.node.id}:{afterItemId:e.props.node.id};e.props.onChange(S(t.dataTransfer.types,e.props.node.parentId||"",Object(d.a)({},i,{isPlaceHolder:n}),e.props.value))}else{var l=e.shouldPlaceBefore(t,"y"),c=e.props.node.childrenIds,u=c.length,s=u?l?{beforeItemId:c[0]}:{afterItemId:c[u-1]}:null;e.props.onChange(S(t.dataTransfer.types,e.props.node.id,Object(d.a)({isPlaceHolder:n},s),e.props.value))}}},e.onDragEnter=function(e){e.preventDefault()},e.onDragOver=function(t){if(e.canDrop(t.dataTransfer.types)&&(t.preventDefault(),t.stopPropagation()),"col"===P(t.dataTransfer.types).draggedNodeType){var n=e.shouldPlaceBefore(t,"x");n&&"left"!==e.state.wantToPlaceNext?e.setState({wantToPlaceNext:"left"}):n||"right"===e.state.wantToPlaceNext||e.setState({wantToPlaceNext:"right"})}else{var r=e.shouldPlaceBefore(t,"y");e.setState({wantToPlaceNext:r?"firstChild":"lastChild"})}},e.onDragLeave=function(t){null!==e.state.wantToPlaceNext&&e.setState({wantToPlaceNext:null})},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"renderChild",value:function(e){var t=this.props,n=t.value,r=t.onChange,a=t.renderEditBlock;return a({node:n.byId[e],renderEditBlock:a,value:n,onChange:r})}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,r=t.value.byId,a=this.state.wantToPlaceNext,o=n.childrenIds,i="firstChild"===a?3:0;return Object(b.createElement)("div",{key:"col_"+n.id,style:{display:"flex",flexDirection:"row",width:"100%",height:"100%"}},"left"===a&&Object(b.createElement)("div",{style:{height:"100%",width:3,backgroundColor:"white"}}),Object(b.createElement)("div",{ref:function(t){return e.selfRef=t},onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onDrop,onDragEnter:this.onDragEnter,draggable:!0,onDragStart:function(t){return T(t,e.props.node,e.getBoundingRect)},style:{width:"100%",height:"100%",borderRadius:3,backgroundColor:this.props.node.isPlaceHolder?"grey":this.props.node.backgroundColor||"#ffffffa8",borderStyle:"solid",borderWidth:1}},"firstChild"===a&&Object(b.createElement)("div",{style:{height:10,width:"100%",backgroundColor:"blue"}}),o.map(function(t){var n=r[t],a=Object(b.createElement)("div",{className:"drag-node",key:"node_"+t,style:{position:"absolute",width:n.width,height:n.height,top:i,left:0}},e.renderChild(t));return i+=n.height,a}),"lastChild"===a&&Object(b.createElement)("div",{style:{top:i,position:"absolute",height:10,width:"100%",backgroundColor:"orange"}})),"right"===a&&Object(b.createElement)("div",{style:{height:"100%",width:3,backgroundColor:"white"}}))}}]),t}(b.Component),F=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(f.a)(t).apply(this,arguments))).state={wantToPlaceNext:null},e.selfRef=null,e.getBoundingRect=function(){return e.selfRef&&e.selfRef.getBoundingClientRect?e.selfRef.getBoundingClientRect():null},e.canDrop=function(e){var t=P(e).draggedNodeType;return"col"===t||"row"===t||"markdown"===t||"image"===t||"layer"===t||"custom"===t},e.shouldPlaceBefore=function(t,n){var r=R(t,e.getBoundingRect());return r&&("y"===n?r.top/r.height<.3:r.left/r.width<.3)},e.onDrop=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.canDrop(t.dataTransfer.types)){t.stopPropagation(),n||null===e.state.wantToPlaceNext||e.setState({wantToPlaceNext:null});var r=P(t.dataTransfer.types),a=r.draggedNodeId,o=r.draggedNodeType;if(a){var i=e.shouldPlaceBefore(t,"y");if("row"===o){var l=i?{beforeItemId:e.props.node.id}:{afterItemId:e.props.node.id};e.props.onChange(S(t.dataTransfer.types,e.props.node.parentId||"",Object(d.a)({},l,{isPlaceHolder:n}),e.props.value))}else{var c=e.shouldPlaceBefore(t,"x"),u=e.props.node.childrenIds,s=u.length,h=s?c?{beforeItemId:u[0]}:{afterItemId:u[s-1]}:null;e.props.onChange(S(t.dataTransfer.types,e.props.node.id,Object(d.a)({isPlaceHolder:n},h),e.props.value))}}}},e.onDragEnter=function(e){e.preventDefault()},e.onDragOver=function(t){var n=P(t.dataTransfer.types).draggedNodeType;if(e.canDrop(t.dataTransfer.types)&&(t.preventDefault(),t.stopPropagation()),"row"===n){var r=e.shouldPlaceBefore(t,"y");r&&"top"!==e.state.wantToPlaceNext?e.setState({wantToPlaceNext:"top"}):r||"bottom"===e.state.wantToPlaceNext||e.setState({wantToPlaceNext:"bottom"})}else{var a=e.shouldPlaceBefore(t,"x");e.setState({wantToPlaceNext:a?"firstChild":"lastChild"})}},e.onDragLeave=function(t){null!==e.state.wantToPlaceNext&&e.setState({wantToPlaceNext:null})},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.node,r=t.value,a=t.onChange,o=t.renderEditBlock,i=this.state.wantToPlaceNext,d="firstChild"===i?3:0;return Object(b.createElement)("div",{key:"row_"+n.id},"top"===i&&Object(b.createElement)("div",{style:{height:3,width:"100%",backgroundColor:"black"}}),Object(b.createElement)("div",{ref:function(t){return e.selfRef=t},onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDragEnter:this.onDragEnter,onDrop:this.onDrop,draggable:!0,onDragStart:function(t){return T(t,e.props.node,e.getBoundingRect)},style:{position:"relative",height:n.height,width:n.width,borderStyle:"dashed",borderWidth:0,borderBottomWidth:1,backgroundColor:n.isPlaceHolder?"darkgrey":n.backgroundColor||"#b5bbb9b0"}},"firstChild"===i&&Object(b.createElement)("div",{style:{height:"100%",width:3,backgroundColor:"blue"}}),n.childrenIds.map(function(e){var t=r.byId[e],n=Object(b.createElement)("div",{className:"drag-node",key:"node_"+t.id,style:{position:"absolute",width:t.width,height:t.height,top:0,left:d}},o({node:t,renderEditBlock:o,value:r,onChange:a}));return d+=t.width,n}),"lastChild"===i&&Object(b.createElement)("div",{style:{position:"absolute",left:d,height:"100%",width:3,backgroundColor:"orange"}})),"bottom"===i&&Object(b.createElement)("div",{style:{height:3,width:"100%",backgroundColor:"green"}}))}}]),t}(b.Component),W=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(f.a)(t).apply(this,arguments))).selfRef=null,e.getBoundingRect=function(){return e.selfRef&&e.selfRef.getBoundingClientRect?e.selfRef.getBoundingClientRect():null},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.node;return Object(b.createElement)("div",{ref:function(t){return e.selfRef=t},draggable:!0,onDragStart:function(t){return T(t,e.props.node,e.getBoundingRect)},style:{width:"100%",height:"100%",backgroundColor:"violet",padding:5,borderRadius:3}},Object(b.createElement)("img",{style:{width:"100%",height:"100%"},src:t.value}))}}]),t}(b.Component),z=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(f.a)(t).apply(this,arguments))).selfRef=null,e.getBoundingRect=function(){return e.selfRef&&e.selfRef.getBoundingClientRect?e.selfRef.getBoundingClientRect():null},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.node,r=t.update,a=n.value;return Object(b.createElement)("div",{ref:function(t){return e.selfRef=t},draggable:!0,onDragStart:function(t){return T(t,e.props.node,e.getBoundingRect)},style:{width:"100%",height:"100%",backgroundColor:"#ffc0cb75",padding:5,borderRadius:3}},Object(b.createElement)("textarea",{className:"form-control",name:"value",placeholder:"Type here...",value:a,onChange:function(e){return r(n.id,{value:e.target.value})}}))}}]),t}(b.Component),_=function(e){var t=e.node,n=e.renderEditBlock,r=e.value,a=e.onChange,o=e.width,i=e.height,d=r.focusedNodeId;return Object(b.createElement)("div",{onClick:function(e){e.stopPropagation(),a(D(r,t))},style:t.id===d?{borderStyle:"dashed",borderWidth:1,borderColor:"orange"}:{}},Object(b.createElement)(y.ResizableBox,{className:"box",width:o,height:i,onResizeStart:function(e){e.preventDefault(),e.stopPropagation()},onResize:function(e,n){var o=n.size,i=o.width,d=o.height;a(x(r,t.id,{width:i,height:d}))}},"col"===t.type?Object(b.createElement)(L,{key:"col_"+t.id,node:t,renderEditBlock:n,value:r,onChange:a}):"row"===t.type?Object(b.createElement)(F,{key:"row_"+t.id,node:t,renderEditBlock:n,value:r,onChange:a}):"markdown"===t.type?Object(b.createElement)(z,{node:t,update:function(e,t){return a(x(r,e,t))}}):"layer"===t.type?Object(b.createElement)(M,{key:"layer_"+t.id,node:t,renderEditBlock:n,value:r,onChange:a}):Object(b.createElement)(W,{key:"image_"+t.id,node:t,renderEditBlock:n,value:r,onChange:a})))},A=function(e){var t=e.node,n=e.renderEditBlock,r=e.value,a=e.onChange;return Object(b.createElement)(_,{width:t.width,height:t.height,renderEditBlock:n,node:t,value:r,onChange:a})},H=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(f.a)(t).apply(this,arguments))).state={value:e.props.value},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){if(this.props.onChange){var e=this.state.value;this.props.onChange(e)}}},{key:"componentDidUpdate",value:function(e,t){if(this.props.onChange&&this.state.value!==t.value){var n=this.state.value;this.props.onChange(n)}else this.props.value&&e.value!==this.props.value&&this.props.value!==this.state.value&&this.setState({value:this.props.value})}},{key:"render",value:function(){var e=this,t=this.props.renderEditBlock,n=this.state.value,r=n.byId[n.rootNodeId];return Object(b.createElement)("div",{style:{position:"relative",width:r.width,height:r.height}},Object(b.createElement)(L,{key:"col_"+r.id,node:r,renderEditBlock:t,value:this.state.value,onChange:function(t){return e.setState({value:t})}}))}}]),t}(b.Component);H.defaultProps={renderEditBlock:A,onChange:function(e){}};var U=function(e){var t=e.byId,n=e.node,r=e.onSelect,a=e.navClassName,o=void 0===a?"breadcrumb":a,i=e.itemClassName,d=void 0===i?"breadcrumb-item btn btn-link active":i;if(!n)return null;for(var l=[],c=n.id;c;){var u=t[c];if(!u)break;l.unshift({label:"".concat(u.type,"-").concat(u.id),id:u.id}),c=u.parentId}return Object(b.createElement)("nav",{"aria-label":"breadcrumb"},Object(b.createElement)("ol",{className:o},l.map(function(e){return Object(b.createElement)("li",{onClick:function(){return r(e.id)},key:"crumb_"+e.id,className:d,"aria-current":"page"},e.label)})))};function J(e,t){var n=e.byId,r=e.rootNodeId,a=e.focusedNodeId,o=(t?t.parentId:a)||r,i=n[o],l=["col","layer"];if((!i||l.indexOf(i.type)<0)&&(!(i=(o=i?i.parentId:null)?n[o]:i)||l.indexOf(i.type)<0))return{error:"Can only add a row inside "+l.join(", ")+", please select a column by clicking on it",value:e};var c=N(n,"row"),u=Object(d.a)({type:"row",height:100,width:i&&i.width?i.width:500},t,{id:c,name:c,childrenIds:[]}),s={};if("col"===(i=(n=k(n,u,i.id))[o]).type&&i&&i.childrenIds.length>=1){var h=i.height/i.childrenIds.length,f=!0,p=!1,v=void 0;try{for(var g,b=i.childrenIds[Symbol.iterator]();!(f=(g=b.next()).done);f=!0){var m=g.value;s[m]=Object(d.a)({},n[m],{height:h})}}catch(y){p=!0,v=y}finally{try{f||null==b.return||b.return()}finally{if(p)throw v}}}return{createdBlock:u,value:Object(d.a)({},e,{byId:Object(d.a)({},n,s),focusedNodeId:a||u.id})}}function G(e,t){var n=e.byId,r=e.rootNodeId,a=e.focusedNodeId,o=(t?t.parentId:a)||r,i=n[o],l=["row","layer"];if((!i||l.indexOf(i.type)<0)&&(!(i=(o=i?i.parentId:null)?n[o]:i)||l.indexOf(i.type)<0))return{error:"Can only add a column inside "+l.join(", ")+", please select a column by clicking on it",value:e};var c=N(n,"col"),u=Object(d.a)({type:"col",width:100,height:i.height?i.height:100},t,{id:c,name:c,childrenIds:[]}),s={};if("row"===(i=(n=k(n,u,o))[o]).type&&i&&i.childrenIds.length>=1){var h=i.width/i.childrenIds.length,f=!0,p=!1,v=void 0;try{for(var g,b=i.childrenIds[Symbol.iterator]();!(f=(g=b.next()).done);f=!0){var m=g.value;s[m]=Object(d.a)({},n[m],{width:h})}}catch(y){p=!0,v=y}finally{try{f||null==b.return||b.return()}finally{if(p)throw v}}}return{createdBlock:u,value:Object(d.a)({},e,{byId:Object(d.a)({},n,s),focusedNodeId:a||u.id})}}function X(e,t){var n=e.byId,r=e.rootNodeId,a=e.focusedNodeId,o=(t?t.parentId:a)||r,i=n[o],l=["row","col","layer"];if(!i||l.indexOf(i.type)<0)return{error:"Can only add a layer inside "+l.join(", "),value:e};var c=N(n,"layer"),u=Object(d.a)({type:"layer",width:Math.max(1,i.width-20),height:Math.max(1,i.height-20)},t,{id:c,name:c,childrenIds:[]});return{createdBlock:u,value:Object(d.a)({},e,{byId:k(n,u,o),focusedNodeId:u.id})}}var Y=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(f.a)(t).apply(this,arguments))).state={selectedMenu:null},e.toggleMenu=function(t){e.setState({selectedMenu:e.state.selectedMenu===t?null:t})},e.renderColorMenuItem=function(t){var n=e.props.value,r=n.byId,a=n.focusedNodeId;if(a){var o=a?r[a]:null;return m.a.createElement(m.a.Fragment,null,m.a.createElement($,{onClick:function(){return e.toggleMenu(t)},color:o[t]}),e.state.selectedMenu===t&&m.a.createElement("div",{style:{position:"absolute",zIndex:100}},m.a.createElement(I.SketchPicker,{color:o[t]||void 0,onChange:function(n){var r=n.hex;e.props.updateBlock(a,Object(g.a)({},t,r)),e.toggleMenu(t)}})))}},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.buttonClassName,n=e.breadCrumbsProps,r=e.value,a=r.byId,o=r.focusedNodeId,i=this.props,d=o?a[o]:null,l=i.focusNode,c=function(e,t,n){return function(r){i.updateBlock(e,Object(g.a)({},t,n?r.target.value?parseInt(r.target.value,10):void 0:r.target.value))}},u=t;return m.a.createElement("div",null,m.a.createElement("div",null,m.a.createElement("button",{"aria-label":"add row",className:u,onClick:function(){return i.addRow()}},"+ Row"),m.a.createElement("button",{"aria-label":"add column",className:u,onClick:function(){return i.addCol()}},"+ Col"),m.a.createElement("button",{"aria-label":"add layer",className:u,onClick:function(){return i.addLayer()}},"+ Layer"),m.a.createElement("button",{"aria-label":"add markdown",className:u,onClick:function(){return i.addMarkDown()}},"+ Text"),m.a.createElement("button",{"aria-label":"add image",className:u,onClick:function(){return i.addImage()}},"+ Image"),m.a.createElement("button",{"aria-label":"add image",className:u,onClick:function(){i.onChange(function(e,t){if(!t)return alert("Please select node to add table to"),e;var n=window.prompt("Enter number or rows (max 10)","5");if(null===n)return e;var r=window.prompt("Enter number or columns (max 10)","5");if(null===r)return e;var a=window.prompt("Enter table width (max 400)","300");if(null===a)return e;var o=window.prompt("Enter table height (max 400)","300");if(null===o)return e;var i=Math.min(parseInt(a,10),400),d=Math.min(parseInt(o,10),400),l=G(e,{width:i,height:d,parentId:t}),c=l.value,u=l.createdBlock;if(!u)return e;e=c;for(var s=u.id,h=Math.max(1,Math.min(parseInt(n,10),10)),f=Math.max(1,Math.min(parseInt(r,10),10)),p=0;p<h;++p){var v=J(e,{height:d/h,parentId:s}),g=v.value,b=v.createdBlock;if(!b)break;e=g;for(var m=0;m<f;++m){var y=G(e,{parentId:b.id,height:b.height,width:b.width/f}),I=y.value;if(!y.createdBlock)break;e=I}}return e}(i.value,i.value.focusedNodeId))}},"+ Table")),d&&m.a.createElement("div",{style:{paddingLeft:15}},this.renderColorMenuItem("color"),this.renderColorMenuItem("backgroundColor"),m.a.createElement("button",{className:u,onClick:function(){return i.moveInDirection(d.id,"left")}},"\u2b05\ufe0f"),m.a.createElement("button",{className:u,onClick:function(){return i.moveInDirection(d.id,"right")}},"\u27a1\ufe0f"),m.a.createElement("button",{className:u,onClick:function(){return i.moveInDirection(d.id,"up")}},"\u2b06"),m.a.createElement("button",{className:u,onClick:function(){return i.moveInDirection(d.id,"down")}},"\u2b07"),m.a.createElement("button",{className:u,onClick:function(){return i.onChange(function(e,t){if(!t)return e;var n=e.byId,r=n[t];if(!r)return e;var a=r.parentId,o=n[a];return o?B(e,t,a,{afterItemId:o.childrenIds[o.childrenIds.length-1]}):e}(i.value,i.value.focusedNodeId))}},"FlipToFront"),m.a.createElement("button",{"aria-label":"copy",className:u,onClick:function(){return i.copyFocused()}},"Copy"),m.a.createElement("button",{"aria-label":"paste",className:u,onClick:function(){return i.paste()}},"Paste"),m.a.createElement("button",{"aria-label":"delete",onClick:i.removeFocused},"\ud83d\uddd1"),m.a.createElement("button",null,m.a.createElement(U,Object.assign({onSelect:function(e){return l(e,!0)},byId:a,node:d},n))),m.a.createElement("div",{style:{paddingBottom:20}},[{prop:"width",numeric:!0},{prop:"height",numeric:!0},{prop:"top",numeric:!0},{prop:"left",numeric:!0},{prop:"borderWidth",numeric:!0},{prop:"borderTopWidth",numeric:!0},{prop:"borderBottomWidth",numeric:!0},{prop:"borderLeftWidth",numeric:!0},{prop:"borderRightWidth",numeric:!0},{prop:"borderStyle",numeric:!1}].map(function(e){return m.a.createElement("div",{style:{display:"inline-block",marginRight:10},className:"form-group"},m.a.createElement("label",{style:{marginRight:5},htmlFor:e.prop,className:"form-label"},e.prop),m.a.createElement("input",{name:e.prop,className:"form-control",key:"prop_"+e.prop,value:void 0===d[e.prop]?"":d[e.prop],onChange:c(d.id,e.prop,e.numeric),type:e.numeric?"numeric":void 0}))}))))}}]),t}(m.a.Component),$=function(e){return m.a.createElement("button",{style:{borderWidth:1,fontSize:11,borderStyle:"solid",justifyContent:"flex-start"},onClick:e.onClick},m.a.createElement("div",{style:{display:"flex"}},m.a.createElement("div",{style:{borderWidth:1,borderRadius:3,borderStyle:"solid",width:20,height:20,backgroundColor:e.color||void 0}}),"\xa0",e.color?"":"none"))},q=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(h.a)(this,Object(f.a)(t).apply(this,arguments))).addRow=function(t){var n=J(e.props.value,t),r=n.error,a=n.value;r?alert(r):e.props.onChange(a)},e.addCol=function(t){var n=G(e.props.value,t),r=n.error,a=n.value;r?alert(r):e.props.onChange(a)},e.addMarkDown=function(t){var n=function(e,t){var n=e.byId,r=e.rootNodeId,a=e.focusedNodeId,o=(t?t.parentId:a)||r,i=n[o],l=["row","col","layer"];if(!i||l.indexOf(i.type)<0)return{error:"Can only add markdown text inside "+l.join(", "),value:e};var c=N(n,"markdown"),u=Object(d.a)({type:"markdown",width:Math.max(1,i.width-20),height:Math.max(1,i.height-20)},t,{id:c,name:c,childrenIds:[]});return{createdBlock:u,value:Object(d.a)({},e,{byId:k(n,u,o),focusedNodeId:u.id})}}(e.props.value,t),r=n.error,a=n.value;r?alert(r):e.props.onChange(a)},e.addImage=function(t){var n=function(e,t){var n=t&&t.value?t.value:window.prompt("Please enter image url","http://lorempixel.com/200/200/");if(null===n)return{error:"no image selected",value:e};var r=e.byId,a=e.rootNodeId,o=e.focusedNodeId,i=(t?t.parentId:o)||a,l=r[i],c=["row","col","layer"];if(!l||c.indexOf(l.type)<0)return{error:"Can only add an image inside "+c.join(", "),value:e};var u=N(r,"image"),s=Object(d.a)({type:"image",value:n,width:200,height:200},t,{id:u,name:u,childrenIds:[]});return{createdBlock:s,value:Object(d.a)({},e,{byId:k(r,s,i),focusedNodeId:s.id})}}(e.props.value,t),r=n.error,a=n.value;r?alert(r):e.props.onChange(a)},e.addLayer=function(t){var n=X(e.props.value,t),r=n.error,a=n.value;r?alert(r):e.props.onChange(a)},e.removeFocused=function(){var t=e.props.value.focusedNodeId;t&&e.destroy(t)},e.focusNode=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.props.value;e.props.onChange(D(r,t,n))},e.create=function(t){e.props.onChange(function(e,t){var n=e.byId,r=N(n),a=Object(d.a)({},n[r],t);return Object(d.a)({},e,{byId:w(n,a)})}(e.props.value,t))},e.updateBlock=function(t,n){e.props.onChange(x(e.props.value,t,n))},e.destroy=function(t){e.props.onChange(function(e,t){var n=e.byId,r=e.rootNodeId,a=e.focusedNodeId;return r===t?(alert("Cannot destroy root node"),Object(d.a)({},e,{byId:n,focusedNodeId:a})):Object(d.a)({},e,{byId:C(n,t),focusedNodeId:a===t?null:a})}(e.props.value,t))},e.move=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.props.onChange(B(e.props.value,t,n,r))},e.moveInDirection=function(t,n){e.props.onChange(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.byId,a=r[t];if(!a)return e;var o=a.parentId;if(!o)return e;var i=r[o];if(!i)return e;var l=r[i.parentId],c=i.childrenIds.indexOf(t);if(c<0)return e;var u={};if("row"===i.type)if("left"===n.direction){if(0===c)return e;u={beforeItemId:i.childrenIds[c-1]}}else{if("right"!==n.direction){if(l&&"col"===l.type){var s=l.childrenIds.indexOf(i.id);return s>0&&"up"===n.direction?B(e,t,l.childrenIds[s-1]):s<l.childrenIds.length-1&&"down"===n.direction?B(e,t,l.childrenIds[s+1]):e}return e}if(c>=i.childrenIds.length-1)return e;u={afterItemId:i.childrenIds[c+1]}}else if("col"===i.type)if("up"===n.direction){if(0===c)return e;u={beforeItemId:i.childrenIds[c-1]}}else{if("down"!==n.direction){if(l&&"row"===l.type){var h=l.childrenIds.indexOf(i.id);return h>0&&"left"===n.direction?B(e,t,l.childrenIds[h-1]):h<l.childrenIds.length-1&&"right"===n.direction?B(e,t,l.childrenIds[h+1]):e}return e}if(c>=i.childrenIds.length-1)return e;u={afterItemId:i.childrenIds[c+1]}}else if("layer"===i.type){var f=("up"===n.direction?-1:"down"===n.direction?1:0)*(n.stepPx||1),p=("left"===n.direction?-1:"right"===n.direction?1:0)*(n.stepPx||1);u={absolutePos:{top:(a.top||0)+f,left:(a.left||0)+p}}}return Object(d.a)({},e,{byId:k(r,Object(d.a)({},a,{isPlaceHolder:u.isPlaceHolder},u.absolutePos?{top:u.absolutePos.top,left:u.absolutePos.left}:{}),o,u)})}(e.props.value,t,{direction:n}))},e.copyFocused=function(){var t=e.props.value,n=t.byId,r=t.focusedNodeId;if(r){var a=n[r];e.props.onChange(Object(d.a)({},e.props.value,{copiedNode:E(n,a)}))}},e.paste=function(){e.props.onChange(j(e.props.value))},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.UiComponent,r=t.onChange,a=t.value,o=t.controlUiProps;return Object(b.createElement)(n,Object.assign({value:a,onChange:r,addRow:this.addRow,addCol:this.addCol,addImage:this.addImage,addLayer:this.addLayer,addMarkDown:this.addMarkDown,moveInDirection:this.moveInDirection,copyFocused:this.copyFocused,paste:this.paste,focusNode:function(t,n){return e.focusNode(a.byId[t],n)},removeFocused:this.removeFocused,updateBlock:this.updateBlock},o))}}]),t}(b.Component);q.defaultProps={UiComponent:Y};n(507),n(508);var K=n(719),Q=n(721),V=n(247),Z=n.n(V),ee=n(242),te=n.n(ee),ne=n(246),re=n.n(ne),ae=n(243),oe=n.n(ae),ie=n(244),de=n.n(ie),le=n(245),ce=n.n(le),ue=n(722),se=n(233),he=Object(K.a)(function(e){return{button:{margin:e.spacing(1)},fab:{margin:e.spacing(1)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:60},input:{display:"none"}}}),fe=function(e){var t=Object(r.useState)(null),n=Object(l.a)(t,2),o=n[0],i=n[1],d=he(),c=function(e){i(o===e?null:e)},u=function(t){var n=e.value,r=n.byId,i=n.focusedNodeId;if(i){var d=i?r[i]:null;return a.a.createElement(a.a.Fragment,null,a.a.createElement(pe,{onClick:function(){return c(t)},color:d[t]}),o===t&&a.a.createElement("div",{style:{position:"absolute",zIndex:100}},a.a.createElement(se.SketchPicker,{color:d[t]||void 0,onChange:function(n){var r=n.hex;e.updateBlock(i,Object(g.a)({},t,r)),c(t)}})))}},s=e.breadCrumbsProps,h=e.value,f=h.byId,p=h.focusedNodeId,v=p?f[p]:null,b=e.focusNode,m=d.button;return a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement(ue.a,{title:"Add Row (position children horizontally)","aria-label":"Add"},a.a.createElement(Q.a,{"aria-label":"add row",className:m,onClick:function(){return e.addRow()}},"+ Row")),a.a.createElement(ue.a,{title:"Add Col (position children vertically)","aria-label":"Add"},a.a.createElement(Q.a,{"aria-label":"add column",className:m,onClick:function(){return e.addCol()}},"+ Col")),a.a.createElement(ue.a,{title:"Click a cell, then add layer to create a sticky part","aria-label":"Add"},a.a.createElement(Q.a,{"aria-label":"add layer",className:m,onClick:function(){return e.addLayer()}},"+ Layer")),a.a.createElement(ue.a,{title:"Add Text (markdown)","aria-label":"Add"},a.a.createElement(Q.a,{"aria-label":"add markdown",className:m,onClick:function(){return e.addMarkDown()}},"+ Text")),a.a.createElement(Q.a,{"aria-label":"add image",className:m,onClick:function(){return e.addImage()}},"+ Image")),v&&a.a.createElement("div",{style:{paddingLeft:15}},u("color"),u("backgroundColor"),a.a.createElement(Q.a,{className:m,onClick:function(){return e.moveInDirection(v.id,"left")}},a.a.createElement(te.a,null)),a.a.createElement(Q.a,{className:m,onClick:function(){return e.moveInDirection(v.id,"right")}},a.a.createElement(oe.a,null)),a.a.createElement(Q.a,{className:m,onClick:function(){return e.moveInDirection(v.id,"up")}},a.a.createElement(de.a,null)),a.a.createElement(Q.a,{className:m,onClick:function(){return e.moveInDirection(v.id,"down")}},a.a.createElement(ce.a,null)),a.a.createElement(ue.a,{title:"Flip to front","aria-label":"Add"},a.a.createElement(Q.a,{className:m,onClick:function(){return e.onChange(function(e,t){if(!t)return e;var n=e.byId,r=n[t];if(!r)return e;var a=r.parentId,o=n[a];return o?B(e,t,a,{afterItemId:o.childrenIds[o.childrenIds.length-1]}):e}(e.value,e.value.focusedNodeId))}},a.a.createElement(re.a,null))),a.a.createElement(Q.a,{"aria-label":"copy",className:m,onClick:function(){return e.copyFocused()}},"Copy"),a.a.createElement(Q.a,{"aria-label":"paste",className:m,onClick:function(){return e.paste()}},"Paste"),a.a.createElement(Q.a,{"aria-label":"delete",className:d.fab,onClick:e.removeFocused},a.a.createElement(Z.a,null)),a.a.createElement(ue.a,{title:"Click breadcrumb to change focused block","aria-label":"Add"},a.a.createElement(Q.a,null,a.a.createElement(U,Object.assign({onSelect:function(e){return b(e,!0)},byId:f,node:v},s))))))},pe=function(e){return a.a.createElement(Q.a,{size:"small",style:{borderWidth:1,fontSize:11,borderStyle:"solid",justifyContent:"flex-start"},onClick:e.onClick},a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{borderWidth:1,borderRadius:3,borderStyle:"solid",width:20,height:20,backgroundColor:e.color||void 0}}),"\xa0",e.color?"":"none"))};var ve=n(248),ge=Object(c.a)(function(e){return{paper:{backgroundColor:"white",position:"absolute",top:"20%",left:"20%",width:"60%",padding:20},breadcrumbNav:{display:"flex",listStyleType:"none",backgroundColor:"#f5f5f5",padding:10,flexDirection:"row"},breadcrumbItem:{cursor:"pointer","&::before":{content:'"  /  "'},marginRight:5}}});function be(e){return a.a.createElement(me,e)}var me=function(e){var t=Object(r.useRef)(null),n=function(){return t&&t.current&&t.current.getBoundingClientRect?t.current.getBoundingClientRect():null},o=e.node.childrenIds&&e.node.childrenIds[0],i=o?e.value.byId[o]:null,l=i&&"layer"===i.type?i:null;return a.a.createElement(ve.ResizableBox,{className:"box",width:e.node.width,height:e.node.height,onResizeStart:function(e){e.preventDefault(),e.stopPropagation()},onResize:function(t,n){var r=n.size,a=r.width,o=r.height;e.onChange(x(e.value,e.node.id,{width:a,height:o}))}},a.a.createElement("div",{ref:t,draggable:!0,onDragStart:function(t){return T(t,e.node,n)},onClick:function(t){t.stopPropagation(),e.onChange(D(e.value,e.node,!0))},style:Object(d.a)({position:"relative",display:"flex",flexDirection:"column",justifyContent:"center",backgroundColor:e.node.backgroundColor||void 0,width:e.node.width,height:e.node.height},e.value.focusedNodeId===e.node.id?{borderStyle:"dashed",borderWidth:1,borderColor:"orange"}:{})},l&&a.a.createElement("div",{style:{position:"absolute",top:0,left:0,width:l.width,height:l.height,backgroundColor:"black"}},l&&e.renderEditBlock(Object(d.a)({},e,{node:l}))),e.node.value?e.node.value.text:"no text"," "))};function ye(e){return(e.node.value&&"myGridCell"===e.node.value.type?be:A)(e)}var Ie=function(){var e=ge(),t=Object(r.useState)({copiedNode:null,focusedNodeId:null,rootNodeId:"container1",byId:{container1:{id:"container1",type:"layer",name:"container1",parentId:null,width:500,height:300,childrenIds:[]}}}),n=Object(l.a)(t,2),o=n[0],i=n[1];return Object(r.useEffect)(function(){i(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=["#D0021B","#F5A623","#4A90E2","#F8E71C","#50E3C2","#417505","#8B572A","#B8E986"],a=0;if(!t)return alert("Please select node to add table to"),e;var o=n?n.numRows+"":window.prompt("Enter number or rows (max 10)","3");if(null===o)return e;var i=n?n.numCols+"":window.prompt("Enter number or columns (max 10)","3");if(null===i)return e;var d=n?n.width+"":window.prompt("Enter table width (max 400)","500");if(null===d)return e;var l=n?n.height+"":window.prompt("Enter table height (max 400)","500");if(null===l)return e;var c=Math.min(parseInt(d,10),500),u=Math.min(parseInt(l,10),500),s=G(e,{width:c,height:u,parentId:t}),h=s.value,f=s.createdBlock;if(!f)return e;e=h;for(var p=f.id,v=Math.max(1,Math.min(parseInt(o,10),10)),g=Math.max(1,Math.min(parseInt(i,10),10)),b=0;b<v;++b){var m=J(e,{height:u/v,width:c,parentId:p}),y=m.value,I=m.createdBlock;if(!I)break;e=y;for(var w=0;w<g;++w){var C=G(e,{parentId:I.id,backgroundColor:r[a++%r.length],height:Math.max(1,I.height-20),width:Math.max(1,I.width/g),value:{type:"myGridCell",text:"i=".concat(b,",j=").concat(w)}}),k=C.value,O=C.createdBlock;if(!O)break;var E=X(e=k,{parentId:O.id,width:50,height:50}),j=E.value;if(!E.createdBlock)break;e=j}}return e}(o,"container1",{width:500,height:500,numCols:3,numRows:3}))},[]),a.a.createElement("div",null,a.a.createElement(q,{value:o,onChange:function(e){return i(e)},UiComponent:fe,controlUiProps:{breadCrumbsProps:{navClassName:e.breadcrumbNav,itemClassName:e.breadcrumbItem}}}),a.a.createElement("div",{style:{marginLeft:10}},a.a.createElement(H,{renderEditBlock:ye,value:o,onChange:i})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(Ie,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[249,1,2]]]);
//# sourceMappingURL=main.380596a1.chunk.js.map