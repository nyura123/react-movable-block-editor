(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{158:function(e,t,n){e.exports=n(430)},163:function(e,t,n){},164:function(e,t,n){},416:function(e,t,n){},430:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(19),d=n.n(o),i=(n(163),n(71)),l=(n(164),n(432)),c=n(28),s=n(16),u=n(30),h=n(29),f=n(31),p=n(51),b=n(36),g=n(4),v=n(1),m=n(143),y=n(144),I=n.n(y),O=n(66);function w(e,t){return Object(g.a)({},e,Object(b.a)({},t.id,t))}function C(e,t){var n=e[t];if(!n)return e;if(n&&n.parentId){var r=e[n.parentId];if(r)if(r.childrenIds.findIndex(function(e){return e===n.id})>=0){var a=r.childrenIds.filter(function(e){return e!==n.id});e=w(e,Object(g.a)({},r,{childrenIds:a}))}}return Object(g.a)({},e,Object(b.a)({},t,void 0))}function j(e,t,n,r){if(!t)return e;if(function e(t,n,r){var a=t[n];if(!a)return!1;if(a.childrenIds.indexOf(r)>=0)return!0;var o=!0,d=!1,i=void 0;try{for(var l,c=a.childrenIds[Symbol.iterator]();!(o=(l=c.next()).done);o=!0)if(e(t,l.value,r))return!1}catch(s){d=!0,i=s}finally{try{o||null==c.return||c.return()}finally{if(d)throw i}}return!1}(e,t.id,n))return console.warn("node ",t.id," has ",n," as child, so cannot make it into",t.id,"'s parent"),e;if(t.id===n)return console.warn("Cannot place into self: ",{id:t.id,newParentId:n}),e;if(t&&t.parentId&&t.parentId!==n){var a=e[t.parentId];if(a){var o=a.childrenIds.filter(function(e){return e!==t.id});e=w(e,Object(g.a)({},a,{childrenIds:o}))}}var d=e[n];if(d){var i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t===n.beforeItemId||t===n.afterItemId)return console.warn("Cannot place relative to self: ",Object(g.a)({itemId:t},n)),e;e=e.filter(function(e){return e!==t});var r=n.beforeItemId,a=n.afterItemId,o=-1;if(r?o=e.findIndex(function(e){return e===r}):a&&(o=e.findIndex(function(e){return e===a})+1),o>=0){var d=Object(p.a)(e);return d.splice(o,0,t),d}return[t].concat(Object(p.a)(e))}(d.childrenIds,t.id,r);e=w(e,Object(g.a)({},d,{childrenIds:i}))}return w(e,Object(g.a)({},t,{parentId:n}))}function k(e,t,n){var r=e.byId,a=Object(g.a)({},r[t],n);return Object(g.a)({},e,{byId:w(r,a)})}function E(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!n)return e;var a=e.byId,o=a[t];return Object(g.a)({},e,{byId:j(a,Object(g.a)({},o,{isPlaceHolder:r.isPlaceHolder},r.absolutePos?{top:r.absolutePos.top,left:r.absolutePos.left}:{}),n,r)})}function N(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t){var r=e.focusedNodeId;return Object(g.a)({},e,{focusedNodeId:n?t.id:r===t.id?null:r})}}function D(e){var t=e.filter(function(e){return 0===e.indexOf("draggednodeid:")}),n=e.filter(function(e){return 0===e.indexOf("draggednodetype:")});return 1!==t.length||1!==n.length?{draggedNodeId:"notanode",draggedNodeType:"invalidnodetype"}:{draggedNodeId:t[0].slice("draggednodeid:".length),draggedNodeType:n[0].slice("draggednodetype:".length)}}function x(e,t){return t?{left:e.clientX-t.left,top:e.clientY-t.top,width:t.width,height:t.height}:null}function P(e,t,n){e.stopPropagation();var r=x(e,n());r&&e.dataTransfer.setData("text/plain",JSON.stringify({startLeft:r.left,startTop:r.top})),e.dataTransfer.setData("draggednodeid:".concat(t.id),""),e.dataTransfer.setData("draggednodetype:".concat(t.type),"")}function R(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return E(arguments.length>3?arguments[3]:void 0,D(e).draggedNodeId,t,n)}var B=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).apply(this,arguments))).selfRef=null,e.getBoundingRect=function(){return e.selfRef&&e.selfRef.getBoundingClientRect?e.selfRef.getBoundingClientRect():null},e.canDrop=function(e){var t=D(e).draggedNodeType;return"markdown"===t||"image"===t||"layer"===t},e.onDrop=function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.canDrop(t.dataTransfer.types)&&(t.stopPropagation(),D(t.dataTransfer.types).draggedNodeId)){var n=x(t,e.getBoundingRect()),r=e.props.node.childrenIds.length?e.props.node.childrenIds[e.props.node.childrenIds.length-1]:void 0,a=JSON.parse(t.dataTransfer.getData("text/plain"));e.props.onChange(R(t.dataTransfer.types,e.props.node.id,n?{afterItemId:r,absolutePos:{top:n.top-a.startTop,left:n.left-a.startLeft}}:void 0,e.props.value))}},e.onDragEnter=function(e){e.preventDefault()},e.onDragOver=function(t){e.canDrop(t.dataTransfer.types)&&(t.preventDefault(),t.stopPropagation())},e}return Object(f.a)(t,e),Object(s.a)(t,[{key:"renderChild",value:function(e){var t=this.props,n=t.value,r=t.onChange,a=t.renderEditBlock;return a({node:n.byId[e],renderEditBlock:a,value:n,onChange:r})}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,r=t.value.byId,a=n.childrenIds;return Object(v.createElement)("div",{ref:function(t){return e.selfRef=t},onDragOver:this.onDragOver,onDrop:this.onDrop,draggable:!0,onDragStart:function(t){return P(t,e.props.node,e.getBoundingRect)},style:{position:"relative",width:n.width,height:n.height,backgroundColor:n.backgroundColor||"darkgrey",padding:5,borderRadius:3}},a.map(function(t){var n=r[t];return Object(v.createElement)("div",{key:"node_"+t,style:{position:"absolute",width:n.width,height:n.height,top:n.top,left:n.left}},e.renderChild(t))}))}}]),t}(v.Component),T=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).apply(this,arguments))).selfRef=null,e.state={wantToPlaceNext:null},e.getBoundingRect=function(){return e.selfRef&&e.selfRef.getBoundingClientRect?e.selfRef.getBoundingClientRect():null},e.canDrop=function(e){var t=D(e).draggedNodeType;return"col"===t||"row"===t||"markdown"===t||"image"===t||"layer"===t},e.shouldPlaceBefore=function(t,n){var r=x(t,e.getBoundingRect());return r&&("y"===n?r.top/r.height<.45:r.left/r.width<.45)},e.onDrop=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.canDrop(t.dataTransfer.types)){t.stopPropagation(),n||null===e.state.wantToPlaceNext||e.setState({wantToPlaceNext:null});var r=D(t.dataTransfer.types),a=r.draggedNodeId,o=r.draggedNodeType;if(a)if("col"===o){var d=e.shouldPlaceBefore(t,"x")?{beforeItemId:e.props.node.id}:{afterItemId:e.props.node.id};e.props.onChange(R(t.dataTransfer.types,e.props.node.parentId||"",Object(g.a)({},d,{isPlaceHolder:n}),e.props.value))}else{var i=e.shouldPlaceBefore(t,"y"),l=e.props.node.childrenIds,c=l.length,s=c?i?{beforeItemId:l[0]}:{afterItemId:l[c-1]}:null;e.props.onChange(R(t.dataTransfer.types,e.props.node.id,Object(g.a)({isPlaceHolder:n},s),e.props.value))}}},e.onDragEnter=function(e){e.preventDefault()},e.onDragOver=function(t){if(e.canDrop(t.dataTransfer.types)&&(t.preventDefault(),t.stopPropagation()),"col"===D(t.dataTransfer.types).draggedNodeType){var n=e.shouldPlaceBefore(t,"x");n&&"left"!==e.state.wantToPlaceNext?e.setState({wantToPlaceNext:"left"}):n||"right"===e.state.wantToPlaceNext||e.setState({wantToPlaceNext:"right"})}else{var r=e.shouldPlaceBefore(t,"y");e.setState({wantToPlaceNext:r?"firstChild":"lastChild"})}},e.onDragLeave=function(t){null!==e.state.wantToPlaceNext&&e.setState({wantToPlaceNext:null})},e}return Object(f.a)(t,e),Object(s.a)(t,[{key:"renderChild",value:function(e){var t=this.props,n=t.value,r=t.onChange,a=t.renderEditBlock;return a({node:n.byId[e],renderEditBlock:a,value:n,onChange:r})}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,r=t.value.byId,a=this.state.wantToPlaceNext,o=n.childrenIds,d="firstChild"===a?3:0;return Object(v.createElement)("div",{key:"col_"+n.id,style:{display:"flex",flexDirection:"row",width:"100%",height:"100%"}},"left"===a&&Object(v.createElement)("div",{style:{height:"100%",width:3,backgroundColor:"white"}}),Object(v.createElement)("div",{ref:function(t){return e.selfRef=t},onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onDrop,onDragEnter:this.onDragEnter,draggable:!0,onDragStart:function(t){return P(t,e.props.node,e.getBoundingRect)},style:{width:"100%",height:"100%",borderRadius:3,backgroundColor:this.props.node.isPlaceHolder?"grey":this.props.node.backgroundColor||"#ffffffa8",borderStyle:"solid",borderWidth:1}},"firstChild"===a&&Object(v.createElement)("div",{style:{height:10,width:"100%",backgroundColor:"blue"}}),o.map(function(t){var n=r[t],a=Object(v.createElement)("div",{className:"drag-node",key:"row_"+t,style:{position:"absolute",width:n.width,height:n.height,top:d,left:0}},e.renderChild(t));return d+=n.height,a}),"lastChild"===a&&Object(v.createElement)("div",{style:{top:d,position:"absolute",height:10,width:"100%",backgroundColor:"orange"}})),"right"===a&&Object(v.createElement)("div",{style:{height:"100%",width:3,backgroundColor:"white"}}))}}]),t}(v.Component),S=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).apply(this,arguments))).state={wantToPlaceNext:null},e.selfRef=null,e.getBoundingRect=function(){return e.selfRef&&e.selfRef.getBoundingClientRect?e.selfRef.getBoundingClientRect():null},e.canDrop=function(e){var t=D(e).draggedNodeType;return"col"===t||"row"===t||"markdown"===t||"image"===t||"layer"===t},e.shouldPlaceBefore=function(t,n){var r=x(t,e.getBoundingRect());return r&&("y"===n?r.top/r.height<.3:r.left/r.width<.3)},e.onDrop=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.canDrop(t.dataTransfer.types)){t.stopPropagation(),n||null===e.state.wantToPlaceNext||e.setState({wantToPlaceNext:null});var r=D(t.dataTransfer.types),a=r.draggedNodeId,o=r.draggedNodeType;if(a){var d=e.shouldPlaceBefore(t,"y");if("row"===o){var i=d?{beforeItemId:e.props.node.id}:{afterItemId:e.props.node.id};e.props.onChange(R(t.dataTransfer.types,e.props.node.parentId||"",Object(g.a)({},i,{isPlaceHolder:n}),e.props.value))}else{var l=e.shouldPlaceBefore(t,"x"),c=e.props.node.childrenIds,s=c.length,u=s?l?{beforeItemId:c[0]}:{afterItemId:c[s-1]}:null;e.props.onChange(R(t.dataTransfer.types,e.props.node.id,Object(g.a)({isPlaceHolder:n},u),e.props.value))}}}},e.onDragEnter=function(e){e.preventDefault()},e.onDragOver=function(t){var n=D(t.dataTransfer.types).draggedNodeType;if(e.canDrop(t.dataTransfer.types)&&(t.preventDefault(),t.stopPropagation()),"row"===n){var r=e.shouldPlaceBefore(t,"y");r&&"top"!==e.state.wantToPlaceNext?e.setState({wantToPlaceNext:"top"}):r||"bottom"===e.state.wantToPlaceNext||e.setState({wantToPlaceNext:"bottom"})}else{var a=e.shouldPlaceBefore(t,"x");e.setState({wantToPlaceNext:a?"firstChild":"lastChild"})}},e.onDragLeave=function(t){null!==e.state.wantToPlaceNext&&e.setState({wantToPlaceNext:null})},e}return Object(f.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.node,r=t.value,a=t.onChange,o=t.renderEditBlock,d=this.state.wantToPlaceNext,i="firstChild"===d?3:0;return Object(v.createElement)("div",{key:"row_"+n.id},"top"===d&&Object(v.createElement)("div",{style:{height:3,width:"100%",backgroundColor:"black"}}),Object(v.createElement)("div",{ref:function(t){return e.selfRef=t},onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDragEnter:this.onDragEnter,onDrop:this.onDrop,draggable:!0,onDragStart:function(t){return P(t,e.props.node,e.getBoundingRect)},style:{position:"relative",height:n.height,width:n.width,borderStyle:"dashed",borderWidth:0,borderBottomWidth:1,backgroundColor:n.isPlaceHolder?"darkgrey":n.backgroundColor||"#b5bbb9b0"}},"firstChild"===d&&Object(v.createElement)("div",{style:{height:"100%",width:3,backgroundColor:"blue"}}),n.childrenIds.map(function(e){var t=r.byId[e],n=Object(v.createElement)("div",{className:"drag-node",key:"node_"+t.id,style:{position:"absolute",width:t.width,height:t.height,top:0,left:i}},o({node:t,renderEditBlock:o,value:r,onChange:a}));return i+=t.width,n}),"lastChild"===d&&Object(v.createElement)("div",{style:{position:"absolute",left:i,height:"100%",width:3,backgroundColor:"orange"}})),"bottom"===d&&Object(v.createElement)("div",{style:{height:3,width:"100%",backgroundColor:"green"}}))}}]),t}(v.Component),M=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).apply(this,arguments))).selfRef=null,e.getBoundingRect=function(){return e.selfRef&&e.selfRef.getBoundingClientRect?e.selfRef.getBoundingClientRect():null},e}return Object(f.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.node;return Object(v.createElement)("div",{ref:function(t){return e.selfRef=t},draggable:!0,onDragStart:function(t){return P(t,e.props.node,e.getBoundingRect)},style:{width:"100%",height:"100%",backgroundColor:"violet",padding:5,borderRadius:3}},Object(v.createElement)("img",{style:{width:"100%",height:"100%"},src:t.value}))}}]),t}(v.Component),L=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).apply(this,arguments))).selfRef=null,e.getBoundingRect=function(){return e.selfRef&&e.selfRef.getBoundingClientRect?e.selfRef.getBoundingClientRect():null},e}return Object(f.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.node,r=t.update,a=n.value;return Object(v.createElement)("div",{ref:function(t){return e.selfRef=t},draggable:!0,onDragStart:function(t){return P(t,e.props.node,e.getBoundingRect)},style:{width:"100%",height:"100%",backgroundColor:"#ffc0cb75",padding:5,borderRadius:3}},Object(v.createElement)("textarea",{className:"form-control",name:"value",placeholder:"Type here...",value:a,onChange:function(e){return r(n.id,{value:e.target.value})}}))}}]),t}(v.Component),A=function(e){var t=e.node,n=e.renderEditBlock,r=e.value,a=e.onChange,o=e.width,d=e.height,i=r.focusedNodeId;return Object(v.createElement)("div",{onClick:function(e){e.stopPropagation(),a(N(r,t))},style:t.id===i?{borderStyle:"dashed",borderWidth:1,borderColor:"orange"}:{}},Object(v.createElement)(m.ResizableBox,{className:"box",width:o,height:d,onResizeStart:function(e){e.preventDefault(),e.stopPropagation()},onResize:function(e,n){var o=n.size,d=o.width,i=o.height;a(k(r,t.id,{width:d,height:i}))}},"col"===t.type?Object(v.createElement)(T,{key:"col_"+t.id,node:t,renderEditBlock:n,value:r,onChange:a}):"row"===t.type?Object(v.createElement)(S,{key:"row_"+t.id,node:t,renderEditBlock:n,value:r,onChange:a}):"markdown"===t.type?Object(v.createElement)(L,{node:t,update:function(e,t){return a(k(r,e,t))}}):"layer"===t.type?Object(v.createElement)(B,{key:"layer_"+t.id,node:t,renderEditBlock:n,value:r,onChange:a}):Object(v.createElement)(M,{key:"image_"+t.id,node:t,renderEditBlock:n,value:r,onChange:a})))},_=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).apply(this,arguments))).state={value:e.props.value},e}return Object(f.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){if(this.props.onChange){var e=this.state.value;this.props.onChange(e)}}},{key:"componentDidUpdate",value:function(e,t){if(this.props.onChange&&this.state.value!==t.value){var n=this.state.value;this.props.onChange(n)}else this.props.value&&e.value!==this.props.value&&this.props.value!==this.state.value&&this.setState({value:this.props.value})}},{key:"render",value:function(){var e=this,t=this.props.renderEditBlock,n=this.state.value,r=n.byId[n.rootNodeId];return Object(v.createElement)("div",{style:{position:"relative",width:r.width,height:r.height}},Object(v.createElement)(T,{key:"col_"+r.id,node:r,renderEditBlock:t,value:this.state.value,onChange:function(t){return e.setState({value:t})}}))}}]),t}(v.Component);_.defaultProps={renderEditBlock:function(e){var t=e.node,n=e.renderEditBlock,r=e.value,a=e.onChange;return Object(v.createElement)(A,{width:t.width,height:t.height,renderEditBlock:n,node:t,value:r,onChange:a})},onChange:function(e){}};var F=function e(t){var n=t.node,r=t.byId;switch(n.type){case"markdown":return Object(v.createElement)("div",{key:n.id,style:{color:n.color||void 0,backgroundColor:n.backgroundColor||void 0,height:n.height,width:n.width}},Object(v.createElement)(I.a,{source:n.value}));case"layer":return Object(v.createElement)("div",{key:n.id,style:{position:"relative",color:n.color||void 0,backgroundColor:n.backgroundColor||void 0,height:n.height,width:n.width}},n.childrenIds.map(function(t){var n=r[t];return Object(v.createElement)("div",{key:n.id,style:{position:"absolute",top:n.top||0,left:n.left||0}},Object(v.createElement)(e,{byId:r,node:r[t]}))}));case"image":return Object(v.createElement)("div",{key:n.id,style:{height:"100%",width:"100%"}},Object(v.createElement)("img",{src:n.value}));case"col":return Object(v.createElement)("div",{key:n.id,style:{width:n.width,backgroundColor:n.backgroundColor||void 0,color:n.color||void 0,height:n.height,display:"flex",flexDirection:"column"}},n.childrenIds.map(function(t){return Object(v.createElement)(e,{key:"prev_"+t,byId:r,node:r[t]})}));case"row":return Object(v.createElement)("div",{key:n.id,style:{width:n.width,backgroundColor:n.backgroundColor||void 0,color:n.color||void 0,height:n.height,display:"flex",flexDirection:"row"}},n.childrenIds.map(function(t){return Object(v.createElement)(e,{key:"prev_"+t,byId:r,node:r[t]})}))}},H=function(e){var t=e.byId,n=e.node,r=e.onSelect,a=e.navClassName,o=void 0===a?"breadcrumb":a,d=e.itemClassName,i=void 0===d?"breadcrumb-item btn btn-link active":d;if(!n)return null;for(var l=[],c=n.id;c;){var s=t[c];if(!s)break;l.unshift({label:"".concat(s.type,"-").concat(s.id),id:s.id}),c=s.parentId}return Object(v.createElement)("nav",{"aria-label":"breadcrumb"},Object(v.createElement)("ol",{className:o},l.map(function(e){return Object(v.createElement)("li",{onClick:function(){return r(e.id)},key:"crumb_"+e.id,className:i,"aria-current":"page"},e.label)})))};var W=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).apply(this,arguments))).state={selectedMenu:null},e.renderColorMenuItem=function(t,n){var r=e.props.value,a=r.byId,o=r.focusedNodeId,d=e.state.selectedMenu;if(o){var i=o?a[o]:null;return Object(v.createElement)(v.Fragment,null,Object(v.createElement)("div",{style:{borderStyle:"solid",borderWidth:1,backgroundColor:i[t]||"transparent"},onClick:function(n){return e.toggleMenu(t)}},n),d===t&&Object(v.createElement)("div",{style:{position:"absolute",zIndex:100}},Object(v.createElement)(O.SketchPicker,{color:i[t]||void 0,onChange:function(n){var r=n.hex;e.props.updateBlock(o,Object(b.a)({},t,r)),e.toggleMenu(t)}})))}},e}return Object(f.a)(t,e),Object(s.a)(t,[{key:"toggleMenu",value:function(e){this.setState({selectedMenu:this.state.selectedMenu===e?null:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.buttonClassName,r=t.breadCrumbsProps,a=t.value,o=a.byId,d=a.rootNodeId,i=a.focusedNodeId,l=i?o[i]:d||null,c=this.props.focusNode;return Object(v.createElement)("div",null,Object(v.createElement)("div",null,Object(v.createElement)("button",{className:n,onClick:function(){return e.props.addRow()}},"Add Row"),Object(v.createElement)("button",{className:n,onClick:function(){return e.props.addCol()}},"Add Col"),Object(v.createElement)("button",{className:n,onClick:this.props.removeFocused},"Remove Selected"),Object(v.createElement)("button",{className:n,onClick:function(){return e.props.addMarkDown()}},"Add Markdown"),Object(v.createElement)("button",{className:n,onClick:function(){return e.props.addImage()}},"Add Image"),Object(v.createElement)("button",{className:n,onClick:function(){return e.props.addLayer()}},"Add Layer")),Object(v.createElement)("div",null,Object(v.createElement)("button",{className:n,onClick:function(){return e.props.copyFocused()}},"Copy"),Object(v.createElement)("button",{className:n,onClick:function(){return e.props.paste()}},"Paste")),l&&Object(v.createElement)("div",null,this.renderColorMenuItem("color","Text"),this.renderColorMenuItem("backgroundColor","Background"),Object(v.createElement)(H,Object.assign({onSelect:function(e){return c(e,!0)},byId:o,node:l},r)),Object(v.createElement)("button",{className:n,onClick:function(){return e.props.moveInDirection(l.id,"up")}},"Move Up"),Object(v.createElement)("button",{className:n,onClick:function(){return e.props.moveInDirection(l.id,"down")}},"Move Down"),Object(v.createElement)("button",{className:n,onClick:function(){return e.props.moveInDirection(l.id,"left")}},"Move Left"),Object(v.createElement)("button",{className:n,onClick:function(){return e.props.moveInDirection(l.id,"right")}},"Move Right")))}}]),t}(v.Component);W.defaultProps={buttonClassName:"btn btn default"};var z=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).apply(this,arguments))).addRow=function(t){var n=function(e,t){var n=e.byId,r=e.rootNodeId,a=e.focusedNodeId,o=(t?t.parentId:a)||r,d=n[o];if(!(d&&"col"===d.type||(o=d?d.parentId:null,d=o?n[o]:d,d&&"col"===d.type)))return{error:"Can only add a row inside a column, please select a column by clicking on it",value:e};var i="row"+(Object.keys(n).length+1),l=Object(g.a)({type:"row",height:100,width:d&&d.width?d.width:500},t,{id:i,name:i,childrenIds:[]}),c={};if((d=(n=j(n,l,d.id))[o])&&d.childrenIds.length>=1){var s=d.height/d.childrenIds.length,u=!0,h=!1,f=void 0;try{for(var p,b=d.childrenIds[Symbol.iterator]();!(u=(p=b.next()).done);u=!0){var v=p.value;c[v]=Object(g.a)({},n[v],{height:s})}}catch(m){h=!0,f=m}finally{try{u||null==b.return||b.return()}finally{if(h)throw f}}}return{value:Object(g.a)({},e,{byId:Object(g.a)({},n,c),focusedNodeId:a||l.id})}}(e.props.value,t),r=n.error,a=n.value;r?alert(r):e.props.onChange(a)},e.addCol=function(t){var n=function(e,t){var n=e.byId,r=e.rootNodeId,a=e.focusedNodeId,o=(t?t.parentId:a)||r,d=n[o];if(!(d&&"row"===d.type||(o=d?d.parentId:null,d=o?n[o]:d,d&&"row"===d.type)))return{error:"'Can only add a column inside a row, please select a row by clicking on it",value:e};var i="col"+(Object.keys(n).length+1),l=Object(g.a)({type:"col",width:100,height:d.height?d.height:100},t,{id:i,name:i,childrenIds:[]}),c={};if((d=(n=j(n,l,o))[o])&&d.childrenIds.length>=1){var s=d.width/d.childrenIds.length,u=!0,h=!1,f=void 0;try{for(var p,b=d.childrenIds[Symbol.iterator]();!(u=(p=b.next()).done);u=!0){var v=p.value;c[v]=Object(g.a)({},n[v],{width:s})}}catch(m){h=!0,f=m}finally{try{u||null==b.return||b.return()}finally{if(h)throw f}}}return{value:Object(g.a)({},e,{byId:Object(g.a)({},n,c),focusedNodeId:a||l.id})}}(e.props.value,t),r=n.error,a=n.value;r?alert(r):e.props.onChange(a)},e.addMarkDown=function(t){var n=function(e,t){var n=e.byId,r=e.rootNodeId,a=e.focusedNodeId,o=(t?t.parentId:a)||r,d=n[o];if(!d||["row","col","layer"].indexOf(d.type)<0)return{error:"Can only add markdown text inside "+["row","col","layer"].join(", "),value:e};var i="markdown"+(Object.keys(n).length+3),l=Object(g.a)({type:"markdown",width:Math.max(50,d.width-20),height:Math.max(50,d.height-20)},t,{id:i,name:i,childrenIds:[]});return{value:Object(g.a)({},e,{byId:j(n,l,o),focusedNodeId:l.id})}}(e.props.value,t),r=n.error,a=n.value;r?alert(r):e.props.onChange(a)},e.addImage=function(t){var n=function(e,t){var n=t&&t.value?t.value:window.prompt("Please enter image url","http://lorempixel.com/200/200/");if(null===n)return{error:"no image selected",value:e};var r=e.byId,a=e.rootNodeId,o=e.focusedNodeId,d=(t?t.parentId:o)||a,i=r[d];if(!i||["row","col","layer"].indexOf(i.type)<0)return{error:"Can only add an image inside "+["row","col","layer"].join(", "),value:e};var l="image"+(Object.keys(r).length+3),c=Object(g.a)({type:"image",value:n,width:Math.max(50,i.width-20),height:Math.max(50,i.height-20)},t,{id:l,name:l,childrenIds:[]});return{value:Object(g.a)({},e,{byId:j(r,c,d),focusedNodeId:c.id})}}(e.props.value,t),r=n.error,a=n.value;r?alert(r):e.props.onChange(a)},e.addLayer=function(t){var n=function(e,t){var n=e.byId,r=e.rootNodeId,a=e.focusedNodeId,o=(t?t.parentId:a)||r,d=n[o];if(!d||["row","col","layer"].indexOf(d.type)<0)return{error:"Can only add a layer inside "+["row","col","layer"].join(", "),value:e};var i="layer"+(Object.keys(n).length+3),l=Object(g.a)({type:"layer",width:Math.max(50,d.width-20),height:Math.max(50,d.height-20)},t,{id:i,name:i,childrenIds:[]});return{value:Object(g.a)({},e,{byId:j(n,l,o),focusedNodeId:l.id})}}(e.props.value,t),r=n.error,a=n.value;r?alert(r):e.props.onChange(a)},e.removeFocused=function(){var t=e.props.value.focusedNodeId;t&&e.destroy(t)},e.focusNode=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.props.value;e.props.onChange(N(r,t,n))},e.create=function(t){e.props.onChange(function(e,t){for(var n=e.byId,r=Object.keys(n).length;n[r];)r++;var a="node_"+r,o=Object(g.a)({},n[a],t);return Object(g.a)({},e,{byId:w(n,o)})}(e.props.value,t))},e.updateBlock=function(t,n){e.props.onChange(k(e.props.value,t,n))},e.destroy=function(t){e.props.onChange(function(e,t){var n=e.byId,r=e.rootNodeId,a=e.focusedNodeId;return r===t?(alert("Cannot destroy root node"),Object(g.a)({},e,{byId:n,focusedNodeId:a})):Object(g.a)({},e,{byId:C(n,t),focusedNodeId:a===t?null:a})}(e.props.value,t))},e.move=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.props.onChange(E(e.props.value,t,n,r))},e.moveInDirection=function(t,n){e.props.onChange(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.byId,a=r[t];if(!a)return e;var o=a.parentId;if(!o)return e;var d=r[o];if(!d)return e;var i=r[d.parentId],l=d.childrenIds.indexOf(t);if(l<0)return e;var c={};if("row"===d.type)if("left"===n.direction){if(0===l)return e;c={beforeItemId:d.childrenIds[l-1]}}else{if("right"!==n.direction){if(i){var s=i.childrenIds.indexOf(d.id);return s>0&&"up"===n.direction?E(e,t,i.childrenIds[s-1]):s<i.childrenIds.length-1&&"down"===n.direction?E(e,t,i.childrenIds[s+1]):e}return e}if(l>=d.childrenIds.length-1)return e;c={afterItemId:d.childrenIds[l+1]}}else if("col"===d.type)if("up"===n.direction){if(0===l)return e;c={beforeItemId:d.childrenIds[l-1]}}else{if("down"!==n.direction){if(i){var u=i.childrenIds.indexOf(d.id);return u>0&&"left"===n.direction?E(e,t,i.childrenIds[u-1]):u<i.childrenIds.length-1&&"right"===n.direction?E(e,t,i.childrenIds[u+1]):e}return e}if(l>=d.childrenIds.length-1)return e;c={afterItemId:d.childrenIds[l+1]}}else if("layer"===d.type){var h=("up"===n.direction?-1:"down"===n.direction?1:0)*(n.stepPx||10),f=("left"===n.direction?-1:"right"===n.direction?1:0)*(n.stepPx||10);c={absolutePos:{top:(a.top||0)+h,left:(a.left||0)+f}}}return Object(g.a)({},e,{byId:j(r,Object(g.a)({},a,{isPlaceHolder:c.isPlaceHolder},c.absolutePos?{top:c.absolutePos.top,left:c.absolutePos.left}:{}),o,c)})}(e.props.value,t,{direction:n}))},e.copyFocused=function(){var t=e.props.value,n=t.byId,r=t.focusedNodeId;if(r){var a=n[r];e.props.onChange(Object(g.a)({},e.props.value,{copiedNode:Object(g.a)({},a)}))}},e.paste=function(){var t=e.props.value.copiedNode;if(t&&t.parentId)switch(t.type){case"row":e.addRow(t);break;case"col":e.addCol(t);break;case"image":e.addImage(t);break;case"markdown":e.addMarkDown(t);break;case"layer":e.addLayer(t)}},e}return Object(f.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.UiComponent,r=t.onChange,a=t.value,o=t.controlUiProps;return Object(v.createElement)(n,Object.assign({value:a,onChange:r,addRow:this.addRow,addCol:this.addCol,addImage:this.addImage,addLayer:this.addLayer,addMarkDown:this.addMarkDown,moveInDirection:this.moveInDirection,copyFocused:this.copyFocused,paste:this.paste,focusNode:function(t,n){return e.focusNode(a.byId[t],n)},removeFocused:this.removeFocused,updateBlock:this.updateBlock},o))}}]),t}(v.Component);z.defaultProps={UiComponent:W};n(416),n(417);var U=n(449),J=n(451),X=n(157),Y=n.n(X),$=n(153),q=n.n($),G=n(154),K=n.n(G),Q=n(155),V=n.n(Q),Z=n(156),ee=n.n(Z),te=n(452),ne=Object(U.a)(function(e){return{button:{margin:e.spacing(1)},fab:{margin:e.spacing(1)},input:{display:"none"}}}),re=function(e){var t=Object(r.useState)(null),n=Object(i.a)(t,2),o=n[0],d=n[1],l=ne(),c=function(e){d(o===e?null:e)},s=function(t){var n=e.value,r=n.byId,d=n.focusedNodeId;if(d){var i=d?r[d]:null;return a.a.createElement(a.a.Fragment,null,a.a.createElement(ae,{onClick:function(){return c(t)},color:i[t]}),o===t&&a.a.createElement("div",{style:{position:"absolute",zIndex:100}},a.a.createElement(O.SketchPicker,{color:i[t]||void 0,onChange:function(n){var r=n.hex;e.updateBlock(d,Object(b.a)({},t,r)),c(t)}})))}},u=e.breadCrumbsProps,h=e.value,f=h.byId,p=(h.rootNodeId,h.focusedNodeId),g=p?f[p]:null,v=e.focusNode,m=l.button;return a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement(te.a,{title:"Add Row (position children horizontally)","aria-label":"Add"},a.a.createElement(J.a,{"aria-label":"add row",className:m,onClick:function(){return e.addRow()}},"+ Row")),a.a.createElement(te.a,{title:"Add Col (position children vertically)","aria-label":"Add"},a.a.createElement(J.a,{"aria-label":"add column",className:m,onClick:function(){return e.addCol()}},"+ Col")),a.a.createElement(te.a,{title:"Add Layer (position children absolutely)","aria-label":"Add"},a.a.createElement(J.a,{"aria-label":"add layer",className:m,onClick:function(){return e.addLayer()}},"+ Layer")),a.a.createElement(te.a,{title:"Add Text (markdown)","aria-label":"Add"},a.a.createElement(J.a,{"aria-label":"add markdown",className:m,onClick:function(){return e.addMarkDown()}},"+ Text")),a.a.createElement(J.a,{"aria-label":"add image",className:m,onClick:function(){return e.addImage()}},"+ Image")),g&&a.a.createElement("div",{style:{paddingLeft:15}},s("color"),s("backgroundColor"),a.a.createElement(J.a,{className:m,onClick:function(){return e.moveInDirection(g.id,"left")}},a.a.createElement(q.a,null)),a.a.createElement(J.a,{className:m,onClick:function(){return e.moveInDirection(g.id,"right")}},a.a.createElement(K.a,null)),a.a.createElement(J.a,{className:m,onClick:function(){return e.moveInDirection(g.id,"up")}},a.a.createElement(V.a,null)),a.a.createElement(J.a,{className:m,onClick:function(){return e.moveInDirection(g.id,"down")}},a.a.createElement(ee.a,null)),a.a.createElement(J.a,{"aria-label":"copy",className:m,onClick:function(){return e.copyFocused()}},"Copy"),a.a.createElement(J.a,{"aria-label":"paste",className:m,onClick:function(){return e.paste()}},"Paste"),a.a.createElement(J.a,{"aria-label":"delete",className:l.fab,onClick:e.removeFocused},a.a.createElement(Y.a,null)),a.a.createElement(te.a,{title:"Click breadcrumb to change focused block","aria-label":"Add"},a.a.createElement(J.a,null,a.a.createElement(H,Object.assign({onSelect:function(e){return v(e,!0)},byId:f,node:g},u))))))},ae=function(e){return a.a.createElement(J.a,{size:"small",style:{borderWidth:1,fontSize:11,borderStyle:"solid",justifyContent:"flex-start"},onClick:e.onClick},a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{borderWidth:1,borderRadius:3,borderStyle:"solid",width:20,height:20,backgroundColor:e.color||void 0}}),"\xa0",e.color?"":"none"))},oe=Object(l.a)({breadcrumbNav:{display:"flex",listStyleType:"none",backgroundColor:"#f5f5f5",padding:10,flexDirection:"row"},breadcrumbItem:{cursor:"pointer","&::before":{content:'"  /  "'},marginRight:5}}),de=function(){var e=oe(),t=Object(r.useState)({copiedNode:null,focusedNodeId:"row1",byId:{container1:{id:"container1",type:"col",name:"container1",parentId:null,width:500,height:300,childrenIds:["row1"]},row1:{id:"row1",type:"row",name:"row1",parentId:"container1",width:500,height:150,childrenIds:[]}},rootNodeId:"container1"}),n=Object(i.a)(t,2),o=n[0],d=n[1];return a.a.createElement("div",null,a.a.createElement(z,{value:o,onChange:d,UiComponent:re,controlUiProps:{breadCrumbsProps:{navClassName:e.breadcrumbNav,itemClassName:e.breadcrumbItem}}}),a.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"}},a.a.createElement(_,{value:o,onChange:d}),a.a.createElement("div",{style:{marginLeft:30,borderWidth:1,borderStyle:"dashed"}},a.a.createElement(F,{byId:o.byId,node:o.byId[o.rootNodeId]}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));d.a.render(a.a.createElement(de,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[158,1,2]]]);
//# sourceMappingURL=main.cb76eeea.chunk.js.map