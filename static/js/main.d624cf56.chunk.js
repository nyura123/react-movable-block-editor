(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{239:function(e,t,n){},283:function(e,t,n){},326:function(e,t){e.exports="data:image/png;base64,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"},346:function(e,t,n){e.exports=n(778)},351:function(e,t,n){},778:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(21),i=n.n(a),d=(n(351),n(66)),l=(n(239),n(779)),c=n(828),u=n(830),s=n(831),h=n(4),p=n(835),f=n(832),m=n(822),g=n(322),b=n(162),v=n(338),I=n(339),y=n(323),C=n.n(y),k=n(324);function w(e,t){var n;return Object(h.a)({},e,((n={})[t.id]=t,n))}function E(e,t){var n,r=e[t];if(!r)return e;if(r&&r.parentId){var o=e[r.parentId];if(o)if(o.childrenIds.findIndex(function(e){return e===r.id})>=0){var a=o.childrenIds.filter(function(e){return e!==r.id});e=w(e,Object(h.a)({},o,{childrenIds:a}))}}return Object(h.a)({},e,((n={})[t]=void 0,n))}function O(e,t,n,r){if(!t)return e;if(function e(t,n,r){var o=t[n];if(!o)return!1;if(o.childrenIds.indexOf(r)>=0)return!0;for(var a=0,i=o.childrenIds;a<i.length;a++)if(e(t,i[a],r))return!1;return!1}(e,t.id,n))return console.warn("node ",t.id," has ",n," as child, so cannot make it into",t.id,"'s parent"),e;if(t.id===n)return console.warn("Cannot place into self: ",{id:t.id,newParentId:n}),e;if(t&&t.parentId&&t.parentId!==n){var o=e[t.parentId];if(o){var a=o.childrenIds.filter(function(e){return e!==t.id});e=w(e,Object(h.a)({},o,{childrenIds:a}))}}var i=e[n];return i&&(a=function(e,t,n){if(void 0===n&&(n={}),t===n.beforeItemId||t===n.afterItemId)return console.warn("Cannot place relative to self: ",Object(h.a)({itemId:t},n)),e;e=e.filter(function(e){return e!==t});var r=n.beforeItemId,o=n.afterItemId,a=-1;if(r?a=e.findIndex(function(e){return e===r}):o&&(a=e.findIndex(function(e){return e===o})+1),a>=0){var i=e.slice();return i.splice(a,0,t),i}return e.concat([t])}(i.childrenIds,t.id,r),e=w(e,Object(h.a)({},i,{childrenIds:a}))),w(e,Object(h.a)({},t,{parentId:n}))}var j=n(321).cloneDeep;function N(e,t){return t?Object(h.a)({},t,{value:j(t.value),childrenIds:t.childrenIds.slice(),children:t.childrenIds.map(function(t){var n=e[t];return N(e,n)})}):t}function A(e){var t=e.byId,n=(e||{copiedNode:null}).copiedNode;if(!n)return e;var r=function e(t,n){var r;n.id=B(t,n.type);var o=n.children;if(n.children=void 0,t=Object(h.a)({},t,(r={},r[n.id]=n,r)),o)for(var a=0,i=0,d=o;i<d.length;i++){var l=d[i];l.parentId=n.id;var c=e(t,l),u=c.byId,s=c.newId;n.childrenIds[a]=s,t=u,++a}return{byId:t,newId:n.id}}(t,n=j(n)).byId;if(n.parentId){var o=t[n.parentId];if(o)return Object(h.a)({},e,{byId:O(r,n,n.parentId,{afterItemId:o.childrenIds[o.childrenIds.length-1]})})}return e}function B(e,t){void 0===t&&(t="node");for(var n=Object.keys(e).length;e[n];)n++;return t+"_"+n}function x(e,t,n){var r=e.byId,o=Object(h.a)({},r[t],n);return o?Object(h.a)({},e,{byId:w(r,o)}):e}function R(e,t,n,r){if(void 0===r&&(r={}),!n)return e;var o=e.byId,a=o[t];return Object(h.a)({},e,{byId:O(o,Object(h.a)({},a,{isPlaceHolder:r.isPlaceHolder},r.absolutePos?{top:r.absolutePos.top,left:r.absolutePos.left}:{}),n,r)})}function P(e,t,n){if(void 0===n&&(n=!0),!t)return e;var r=e.focusedNodeId;return Object(h.a)({},e,{focusedNodeId:n?t.id:r===t.id?null:r})}function S(e,t){var n=e.clientX,r=e.clientY;return t?{left:n-t.left,top:r-t.top,width:t.width,height:t.height}:null}function W(e,t,n){return void 0===n&&(n={}),function(r){return R(r,e,t,n)}}var V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(h.b)(t,e),t.prototype.renderChild=function(e){var t=this.props,n=t.changeBlocks,r=t.getNode,o=t.undoRedoVersion,a=t.focusedNodeId,i=t.renderEditBlock,d=r(e);return d?i({node:d,renderEditBlock:i,undoRedoVersion:o,changeBlocks:n,getNode:r,focusedNodeId:a}):null},t.prototype.render=function(){var e=this,t=this.props,n=t.node,o=t.getNode,a=n.childrenIds,i=(void 0!==n.paddingLeftPercentWidth?n.paddingLeftPercentWidth:.05)*n.width,d=(void 0!==n.paddingTopPercentHeight?n.paddingTopPercentHeight:.05)*n.height;return Object(r.createElement)("div",{style:{position:"relative",width:n.width,height:n.height,backgroundColor:n.backgroundColor||"#f5f5f5a3",borderRadius:3}},a.map(function(t){var n=o(t);return n?Object(r.createElement)("div",{key:"node_"+t,style:{position:"absolute",width:n.width,height:n.height,top:d,left:i,transform:"translate("+n.left+"px,"+n.top+"px)"}},e.renderChild(t)):null}))},t}(r.Component),T=function(e){var t=Object(r.useRef)(null),n=Object(p.a)({item:{type:"col",id:e.node.id},collect:function(e){return{isDragging:e.isDragging()}}})[1],o=Object(f.a)({accept:["col","row","layer","custom","image","markdown"],canDrop:function(e){var t=e.type;return"row"===t||"col"===t||"markdown"===t||"image"===t||"layer"===t||"custom"===t},drop:function(t,n){var r=n.isOver({shallow:!0}),o=n.getClientOffset(),i=n.getSourceClientOffset(),d=n.getInitialClientOffset(),l=n.getInitialSourceClientOffset();if(!(r&&t&&i&&o&&d&&l))return null;var c=S({clientX:o.x,clientY:o.y},a()),u=e.node.childrenIds.length?e.node.childrenIds[e.node.childrenIds.length-1]:void 0;return e.changeBlocks(W(t.id,e.node.id,c?{afterItemId:u,absolutePos:{top:c.top-(d.y-l.y),left:c.left-(d.x-l.x)}}:void 0)),{type:"layer",id:e.node.id}},collect:function(e){var t=e.getItem();return{isOver:e.isOver({shallow:!0}),initialClientOffset:e.getInitialClientOffset(),clientOffset:e.getClientOffset(),dragSourceItemType:t?t.type:"",dragSourceItemId:t?t.id:"",sourceClientOffset:e.getSourceClientOffset(),initialSourceClientOffset:e.getInitialSourceClientOffset()}}})[1],a=function(){return t.current&&t.current.getBoundingClientRect?t.current.getBoundingClientRect():null};return Object(r.createElement)("div",{ref:t,style:{width:"100%",height:"100%"}},Object(r.createElement)("div",{ref:o,style:{width:"100%",height:"100%"}},Object(r.createElement)("div",{ref:n,style:{width:"100%",height:"100%"}},Object(r.createElement)(V,Object(h.a)({},e)))))},L=function(e){var t=e.wantToPlaceNext,n=e.children,r=e.node,a=e.getNode,i=r.childrenIds,d=(void 0!==r.paddingLeftPercentWidth?r.paddingLeftPercentWidth:.05)*r.width,l=(void 0!==r.paddingTopPercentHeight?r.paddingTopPercentHeight:.05)*r.height,c="firstChild"===t?3:0;return o.a.createElement("div",{key:"col_"+r.id,style:{display:"flex",flexDirection:"row",width:"100%",height:"100%"}},"left"===t&&o.a.createElement("div",{style:{height:"100%",width:3,backgroundColor:"green"}}),o.a.createElement("div",{style:{width:"100%",height:"100%",position:"relative",borderRadius:3,backgroundColor:e.node.isPlaceHolder?"grey":e.node.backgroundColor||"#ffffffa8",borderStyle:"dashed",borderWidth:1}},"firstChild"===t&&o.a.createElement("div",{style:{height:10,width:"100%",position:"absolute",top:l,left:d,transform:"translate(0,"+c+"px)",backgroundColor:"blue"}}),o.a.Children.count(n)?n:i.map(function(t){var n=a(t);if(!n)return null;var r=o.a.createElement("div",{className:"drag-node",key:"node_"+t,style:{position:"absolute",width:n.width,height:n.height,top:l,left:d,transform:"translate(0,"+c+"px)"}},function(t){var n=e.getNode,r=e.changeBlocks,o=e.undoRedoVersion,a=e.focusedNodeId,i=e.renderEditBlock,d=n(t);return d?i({node:d,undoRedoVersion:o,renderEditBlock:i,focusedNodeId:a,changeBlocks:r,getNode:n}):null}(t));return c+=n.height,r}),"lastChild"===t&&o.a.createElement("div",{style:{top:d,left:l,transform:"translate(0,"+c+"px)",position:"absolute",height:10,width:"100%",backgroundColor:"orange"}})),"right"===t&&o.a.createElement("div",{style:{height:"100%",width:3,backgroundColor:"white"}}))},D=function(e){var t=Object(r.useRef)(null),n=Object(p.a)({item:{type:"col",id:e.node.id},collect:function(e){return{isDragging:e.isDragging()}}})[1],a=Object(f.a)({accept:["col","row","layer","custom","image","markdown"],canDrop:function(t){var n=e.getNode,r=e.node,o=r.parentId?n(r.parentId):null,a=t.type;return"col"===a&&o&&"row"===o.type||!e.children&&("row"===a||"markdown"===a||"image"===a||"layer"===a||"custom"===a)},drop:function(t,n){if(!n.isOver({shallow:!0})||!t)return null;if("col"===t.type){var r=s("x"),o=r?{beforeItemId:e.node.id}:{afterItemId:e.node.id};e.changeBlocks(W(t.id,e.node.parentId||"",Object(h.a)({},o)))}else{r=s("y");var a=e.node.childrenIds,i=a.length;o=i?r?{beforeItemId:a[0]}:{afterItemId:a[i-1]}:null,e.changeBlocks(W(t.id,e.node.id,Object(h.a)({},o)))}return{type:"col",id:e.node.id}},collect:function(e){var t=e.getItem();return{isOver:e.isOver({shallow:!0}),initialClientOffset:e.getInitialClientOffset(),clientOffset:e.getClientOffset(),dragSourceItemType:t?t.type:"",dragSourceItemId:t?t.id:"",initialSourceClientOffset:e.getInitialSourceClientOffset()}}}),i=a[0],d=i.clientOffset,l=i.dragSourceItemType,c=i.isOver,u=a[1],s=function(e){if(!d||!c)return!1;var n=S({clientX:d.x,clientY:d.y},t.current&&t.current.getBoundingClientRect?t.current.getBoundingClientRect():null);return n&&("y"===e?n.top/n.height<.45:n.left/n.width<.45)},m=l&&c?"col"===l?s("x")?"left":"right":s("y")?"firstChild":"lastChild":null;return o.a.createElement("div",{ref:t,style:{width:"100%",height:"100%"}},o.a.createElement("div",{ref:u,style:{width:"100%",height:"100%"}},o.a.createElement("div",{ref:n,style:{width:"100%",height:"100%"}},o.a.createElement(L,Object(h.a)({},e,{wantToPlaceNext:m})))))},H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(h.b)(t,e),t.prototype.render=function(){var e=this.props.children,t=this.props,n=t.wantToPlaceNext,o=t.node,a=t.getNode,i=t.undoRedoVersion,d=t.changeBlocks,l=t.renderEditBlock,c=t.focusedNodeId,u=(void 0!==o.paddingLeftPercentWidth?o.paddingLeftPercentWidth:.05)*o.width,s=(void 0!==o.paddingTopPercentHeight?o.paddingTopPercentHeight:.05)*o.height,h="firstChild"===n?3:0;return Object(r.createElement)("div",{key:"row_"+o.id},"top"===n&&Object(r.createElement)("div",{style:{height:3,width:"100%",backgroundColor:"black"}}),Object(r.createElement)("div",{style:{position:"relative",height:o.height,width:o.width,borderStyle:"dashed",borderWidth:0,borderBottomWidth:1,backgroundColor:o.isPlaceHolder?"darkgrey":o.backgroundColor||"#b5bbb9b0"}},"firstChild"===n&&Object(r.createElement)("div",{style:{height:"100%",width:3,backgroundColor:"blue",position:"absolute",top:s,left:u,transform:"translate("+h+"px,0)"}}),r.Children.count(e)?e:o.childrenIds.map(function(e){var t=a(e);if(!t)return null;var n=Object(r.createElement)("div",{className:"drag-node",key:"node_"+t.id,style:{position:"absolute",width:t.width,height:t.height,top:s,left:u,transform:"translate("+h+"px,0)"}},l({node:t,getNode:a,undoRedoVersion:i,focusedNodeId:c,renderEditBlock:l,changeBlocks:d}));return h+=t.width,n}),"lastChild"===n&&Object(r.createElement)("div",{style:{position:"absolute",top:s,left:u,transform:"translate("+h+"px,0)",height:"100%",width:3,backgroundColor:"orange"}})),"bottom"===n&&Object(r.createElement)("div",{style:{height:3,width:"100%",backgroundColor:"green"}}))},t}(r.Component),X=function(e){var t=Object(r.useRef)(null),n=Object(p.a)({item:{type:"row",id:e.node.id},collect:function(e){return{isDragging:e.isDragging()}}})[1],o=Object(f.a)({accept:["col","row","layer","custom","image","markdown"],canDrop:function(t){var n=e.getNode,r=e.node,o=r.parentId?n(r.parentId):null,a=t.type;return"row"===a&&o&&"col"===o.type||!e.children&&("col"===a||"markdown"===a||"image"===a||"layer"===a||"custom"===a)},drop:function(t,n){if(!n.isOver({shallow:!0})||!t)return null;if("row"===t.type){var r=u("y"),o=r?{beforeItemId:e.node.id}:{afterItemId:e.node.id};e.changeBlocks(W(t.id,e.node.parentId||"",Object(h.a)({},o)))}else{r=u("x");var a=e.node.childrenIds,i=a.length;o=i?r?{beforeItemId:a[0]}:{afterItemId:a[i-1]}:null,e.changeBlocks(W(t.id,e.node.id,Object(h.a)({},o)))}return{type:"row",id:e.node.id}},collect:function(e){var t=e.getItem();return{isOver:e.isOver({shallow:!0}),initialClientOffset:e.getInitialClientOffset(),clientOffset:e.getClientOffset(),dragSourceItemType:t?t.type:"",dragSourceItemId:t?t.id:"",initialSourceClientOffset:e.getInitialSourceClientOffset()}}}),a=o[0],i=a.clientOffset,d=a.dragSourceItemType,l=a.isOver,c=o[1],u=function(e){if(!i||!l)return!1;var n=S({clientX:i.x,clientY:i.y},t.current&&t.current.getBoundingClientRect?t.current.getBoundingClientRect():null);return n&&("y"===e?n.top/n.height<.3:n.left/n.width<.3)},s=d&&l?"row"===d?u("y")?"top":"bottom":u("x")?"firstChild":"lastChild":null;return Object(r.createElement)("div",{ref:t,style:{width:"100%",height:"100%"}},Object(r.createElement)("div",{ref:c,style:{width:"100%",height:"100%"}},Object(r.createElement)("div",{ref:n,style:{width:"100%",height:"100%"}},Object(r.createElement)(H,Object(h.a)({},e,{wantToPlaceNext:s})))))},M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selfRef=null,t.getBoundingRect=function(){return t.selfRef&&t.selfRef.getBoundingClientRect?t.selfRef.getBoundingClientRect():null},t}return Object(h.b)(t,e),t.prototype.render=function(){var e=this,t=this.props.node;return Object(r.createElement)("div",{ref:function(t){return e.selfRef=t},style:{width:"100%",height:"100%",backgroundColor:"violet",padding:5,borderRadius:3}},Object(r.createElement)("img",{style:{width:"100%",height:"100%"},src:t.value}))},t}(r.Component),z=function(e){var t=Object(p.a)({item:{type:"image",id:e.node.id},collect:function(e){return{isDragging:e.isDragging()}}})[1];return Object(r.createElement)("div",{ref:t,style:{width:"100%",height:"100%"}},Object(r.createElement)(M,Object(h.a)({},e)))},U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selfRef=null,t.getBoundingRect=function(){return t.selfRef&&t.selfRef.getBoundingClientRect?t.selfRef.getBoundingClientRect():null},t}return Object(h.b)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.node,o=t.update,a=n.value;return Object(r.createElement)("div",{ref:function(t){return e.selfRef=t},style:{width:"100%",height:"100%",backgroundColor:"#ffc0cb75",padding:5,borderRadius:3}},Object(r.createElement)("textarea",{className:"form-control",name:"value",placeholder:"Type here...",value:a,style:{width:"95%",height:"95%",outline:"none"},onChange:function(e){return o(n.id,{value:e.target.value})}}))},t}(r.Component),G=function(e){var t=Object(p.a)({item:{type:"markdown",id:e.node.id},collect:function(e){return{isDragging:e.isDragging()}}})[1];return Object(r.createElement)("div",{ref:t,style:{width:"100%",height:"100%"}},Object(r.createElement)(U,Object(h.a)({},e)))},Z=function(e){var t=e.node,n=e.renderEditBlock,o=e.getNode,a=e.undoRedoVersion,i=e.changeBlocks,d=e.focusedNodeId,l=e.width,c=e.height;return Object(r.createElement)("div",{onClick:function(e){e.stopPropagation(),i(function(e){return P(e,t)})},style:t.id===d?{borderStyle:"dashed",borderWidth:1,borderColor:"orange"}:{}},Object(r.createElement)(g.ResizableBox,{className:"box",width:l,height:c,onResizeStart:function(e){e.preventDefault(),e.stopPropagation()},onResize:function(e,n){var r=n.size,o=r.width,a=r.height;i(function(e){return x(e,t.id,{width:o,height:a})})}},"col"===t.type?Object(r.createElement)(D,{key:"col_"+t.id,node:t,renderEditBlock:n,getNode:o,changeBlocks:i,focusedNodeId:d,undoRedoVersion:a}):"row"===t.type?Object(r.createElement)(X,{key:"row_"+t.id,node:t,renderEditBlock:n,getNode:o,changeBlocks:i,focusedNodeId:d,undoRedoVersion:a}):"markdown"===t.type?Object(r.createElement)(G,{node:t,update:function(e,t){return i(function(n){return x(n,e,t)})}}):"layer"===t.type?Object(r.createElement)(T,{key:"layer_"+t.id,node:t,renderEditBlock:n,getNode:o,changeBlocks:i,focusedNodeId:d,undoRedoVersion:a}):Object(r.createElement)(z,{key:"image_"+t.id,node:t,renderEditBlock:n,getNode:o,changeBlocks:i,focusedNodeId:d,undoRedoVersion:a})))},F=function(e){var t=e.node,n=e.renderEditBlock,o=e.getNode,a=e.changeBlocks,i=e.undoRedoVersion,d=e.focusedNodeId;return Object(r.createElement)(Z,{width:t.width,height:t.height,renderEditBlock:n,node:t,getNode:o,changeBlocks:a,focusedNodeId:d,undoRedoVersion:i})},Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.haveHtml5DndAPI=function(){if(!!navigator.userAgent.match("iPhone OS")||!!navigator.userAgent.match("iPad"))return!1;var e=window.document.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e}(),t.state={value:t.props.value},t.getNode=function(e){return t.state.value.byId[e]},t.onSendOp=function(e){var n=e(t.state.value);t.setState({value:n})},t}return Object(h.b)(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=this.state.value;this.props.onChange(e)}},t.prototype.componentDidUpdate=function(e,t){if(this.props.onChange&&this.state.value!==t.value&&this.state.value!==this.props.value){var n=this.state.value;this.props.onChange(n)}else this.props.value&&e.value!==this.props.value&&this.props.value!==this.state.value&&this.setState({value:this.props.value});this.state.value.byId!==t.value.byId&&this.state.value.undoStack===t.value.undoStack&&this.setState({value:Object(h.a)({},this.state.value,{undoStack:[Object(b.a)(t.value.byId)].concat(this.state.value.undoStack).slice(0,10)})})},t.prototype.render=function(){var e=this.props.renderEditBlock,t=this.state.value,n=t.byId,o=t.rootNodeId,a=t.undoRedoVersion,i=n[o],d=this.haveHtml5DndAPI?v.a:I.a;return Object(r.createElement)("div",{style:{position:"relative",width:i.width,height:i.height}},Object(r.createElement)(m.a,{backend:d},Object(r.createElement)(D,{key:"col_"+i.id,undoRedoVersion:a,node:i,getNode:this.getNode,changeBlocks:this.onSendOp,focusedNodeId:this.state.value.focusedNodeId,renderEditBlock:e})))},t.defaultProps={renderEditBlock:F,onChange:function(e){}},t}(r.Component);function Q(e){return!!e.borderWidth&&e.borderWidth>0||!!e.borderTopWidth&&e.borderTopWidth>0||!!e.borderBottomWidth&&e.borderBottomWidth>0||!!e.borderLeftWidth&&e.borderLeftWidth>0||!!e.borderRightWidth&&e.borderRightWidth>0}var J=function(e){return{color:e.color||void 0,display:e.display||void 0,flexDirection:e.flexDirection||void 0,justifyContent:e.justifyContent||void 0,alignItems:e.alignItems||void 0,backgroundColor:e.backgroundColor||void 0,borderWidth:void 0!==e.borderWidth?e.borderWidth:0,borderTopWidth:void 0!==e.borderTopWidth?e.borderTopWidth:void 0,borderBottomWidth:void 0!==e.borderBottomWidth?e.borderBottomWidth:void 0,borderLeftWidth:void 0!==e.borderLeftWidth?e.borderLeftWidth:void 0,borderRightWidth:void 0!==e.borderRightWidth?e.borderRightWidth:void 0,borderStyle:e.borderStyle?e.borderStyle||void 0:Q(e)?"solid":void 0}},q=function(e){var t=e.byId,n=e.node,o=e.renderPreviewBlock,a=void 0===o?K:o;if(!n)return null;switch(n.type){case"markdown":return Object(r.createElement)("div",{key:n.id,style:Object(h.a)({},J(n),{height:n.height,width:n.width})},Object(r.createElement)(C.a,{source:n.value}));case"layer":return Object(r.createElement)("div",{key:n.id,style:Object(h.a)({position:"relative"},J(n),{height:n.height,width:n.width})},n.childrenIds.map(function(e){var o=t[e];return o?Object(r.createElement)("div",{key:o.id,style:{position:"absolute",top:o.top||0,left:o.left||0}},a({byId:t,node:o,renderPreviewBlock:a})):Object(r.createElement)("div",null,"Error in layer ",n.id,": child node ",e," not found")}));case"image":return Object(r.createElement)("div",{key:n.id,style:{height:"100%",width:"100%"}},Object(r.createElement)("img",{src:n.value}));case"col":return Object(r.createElement)("div",{key:n.id,style:Object(h.a)({},J(n),{width:n.width,height:n.height,display:"flex",flexDirection:"column"})},n.childrenIds.map(function(e){var o=t[e];return o?a({byId:t,node:o,renderPreviewBlock:a}):Object(r.createElement)("div",null,"Error in col ",n.id,": child node ",e," not found")}));case"row":return Object(r.createElement)("div",{key:n.id,style:Object(h.a)({},J(n),{width:n.width,height:n.height,display:"flex",flexDirection:"row"})},n.childrenIds.map(function(e){var o=t[e];return o?a({byId:t,node:o,renderPreviewBlock:a}):Object(r.createElement)("div",null,"Error in row ",n.id,": child node ",e," not found")}));case"custom":return null}},K=function(e){var t=e.byId,n=e.node,o=e.renderPreviewBlock;return Object(r.createElement)(q,{key:"node_"+n.id,node:n,byId:t,renderPreviewBlock:o})},_=function(e){var t=e.byId,n=e.node,o=e.onSelect,a=e.navClassName,i=void 0===a?"breadcrumb":a,d=e.itemClassName,l=void 0===d?"breadcrumb-item btn btn-link active":d;if(!n)return null;for(var c=[],u=n.id;u;){var s=t[u];if(!s)break;c.unshift({label:s.type+"-"+s.id,id:s.id}),u=s.parentId||""}return Object(r.createElement)("nav",{"aria-label":"breadcrumb"},Object(r.createElement)("ol",{className:i},c.map(function(e){return Object(r.createElement)("li",{onClick:function(){return o(e.id)},key:"crumb_"+e.id,className:l,"aria-current":"page"},e.label)})))},$=.95;function ee(e,t){var n=e.byId,r=e.rootNodeId,o=e.focusedNodeId,a=(t?t.parentId:o)||r,i=n[a],d=["col","layer"];if((!i||d.indexOf(i.type)<0)&&(!(i=(a=i&&i.parentId||"")?n[a]:i)||d.indexOf(i.type)<0))return{error:"Can only add a row inside "+d.join(", ")+", please select a column by clicking on it",value:e};var l=B(n,"row"),c=Object(h.a)({type:"row",height:100,width:i&&i.width?i.width*$:500,paddingLeftPercentWidth:(1-$)/2,paddingTopPercentHeight:(1-$)/2},t,{id:l,name:l,childrenIds:[]}),u={};if((i=(n=O(n,c,i.id))[a])&&"col"===i.type&&i&&i.childrenIds.length>=1)for(var s=Math.max(20,i.height/i.childrenIds.length*$),p=0,f=i.childrenIds;p<f.length;p++){var m=f[p];u[m]=Object(h.a)({},n[m],{height:s})}return{createdBlock:c,value:Object(h.a)({},e,{byId:Object(h.a)({},n,u),focusedNodeId:o||c.id})}}function te(e,t){var n=e.byId,r=e.rootNodeId,o=e.focusedNodeId,a=(t?t.parentId:o)||r,i=n[a],d=["row","layer"];if((!i||d.indexOf(i.type)<0)&&(!(i=(a=i&&i.parentId||"")?n[a]:i)||d.indexOf(i.type)<0))return{error:"Can only add a column inside "+d.join(", ")+", please select a column by clicking on it",value:e};var l=B(n,"col"),c=Object(h.a)({type:"col",width:100,height:i.height?i.height*$:100,paddingLeftPercentWidth:(1-$)/2,paddingTopPercentHeight:(1-$)/2},t,{id:l,name:l,childrenIds:[]}),u={};if((i=(n=O(n,c,a))[a])&&"row"===i.type&&i&&i.childrenIds.length>=1)for(var s=Math.max(20,i.width/i.childrenIds.length*$),p=0,f=i.childrenIds;p<f.length;p++){var m=f[p];u[m]=Object(h.a)({},n[m],{width:s})}return{createdBlock:c,value:Object(h.a)({},e,{byId:Object(h.a)({},n,u),focusedNodeId:o||c.id})}}var ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedMenu:null,selectedColor:null},t.toggleMenu=function(e){if(t.setState({selectedMenu:t.state.selectedMenu===e?null:e}),"color"===e||"backgroundColor"===e){var n=t.props.value,r=n.byId,o=n.focusedNodeId,a=o?r[o]:null;t.setState({selectedColor:a&&a.color||null})}},t.renderColorMenuItem=function(e){var n=t.props.value,r=n.byId,a=n.focusedNodeId;if(a){var i=a?r[a]:null;return o.a.createElement(o.a.Fragment,null,o.a.createElement(re,{onClick:function(){return t.toggleMenu(e)},color:i&&i[e]||""}),t.state.selectedMenu===e&&o.a.createElement("div",{style:{position:"absolute",zIndex:100,backgroundColor:"white"}},o.a.createElement("button",{className:t.props.buttonClassName,onClick:function(){var n;t.props.updateBlock(a,((n={})[e]=void 0,n)),t.toggleMenu(e)}},"Clear"),o.a.createElement("button",{className:t.props.buttonClassName,onClick:function(){var n;t.toggleMenu(e),t.props.updateBlock(a,((n={})[e]=t.state.selectedColor,n))}},"Done"),o.a.createElement(k.SketchPicker,{color:t.state.selectedColor||void 0,onChangeComplete:function(e){var n=e.hex;t.setState({selectedColor:n})}})))}},t}return Object(h.b)(t,e),t.prototype.render=function(){var e=this.props,t=e.buttonClassName,n=e.breadCrumbsProps,r=e.value,a=r.byId,i=r.focusedNodeId,d=this.props,l=i?a[i]:null,c=d.focusNode,u=t;return o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("button",{"aria-label":"add row",className:u,onClick:function(){return d.addRow()}},"+ Row"),o.a.createElement("button",{"aria-label":"add column",className:u,onClick:function(){return d.addCol()}},"+ Col"),o.a.createElement("button",{"aria-label":"add layer",className:u,onClick:function(){return d.addLayer()}},"+ Layer"),o.a.createElement("button",{"aria-label":"add markdown",className:u,onClick:function(){return d.addMarkDown()}},"+ Text"),o.a.createElement("button",{"aria-label":"add image",className:u,onClick:function(){return d.addImage()}},"+ Image"),o.a.createElement("button",{"aria-label":"add image",className:u,onClick:function(){d.onChange(function(e,t){if(!t)return alert("Please select node to add table to"),e;var n=window.prompt("Enter number or rows (max 10)","5");if(null===n)return e;var r=window.prompt("Enter number or columns (max 10)","5");if(null===r)return e;var o=window.prompt("Enter table width (max 400)","300");if(null===o)return e;var a=window.prompt("Enter table height (max 400)","300");if(null===a)return e;var i=Math.min(parseInt(o,10),400),d=Math.min(parseInt(a,10),400),l=te(e,{width:i,height:d,parentId:t}),c=l.value,u=l.createdBlock;if(!u)return e;e=c;for(var s=u.id,h=Math.max(1,Math.min(parseInt(n,10),10)),p=Math.max(1,Math.min(parseInt(r,10),10)),f=0;f<h;++f){var m=ee(e,{height:d/h,parentId:s}),g=m.value,b=m.createdBlock;if(!b)break;e=g;for(var v=0;v<p;++v){var I=te(e,{parentId:b.id,height:b.height,width:b.width/p}),y=I.value;if(!I.createdBlock)break;e=y}}return e}(d.value,d.value.focusedNodeId))}},"+ Table"),o.a.createElement("button",{"aria-label":"undo",className:u,onClick:d.undo},"Undo"),o.a.createElement("button",{"aria-label":"redo",className:u,onClick:d.redo},"Redo")),l&&o.a.createElement("div",{style:{paddingLeft:15}},this.renderColorMenuItem("color"),this.renderColorMenuItem("backgroundColor"),o.a.createElement("button",{className:u,onClick:function(){return d.moveInDirection(l.id,"left")}},"\u2b05\ufe0f"),o.a.createElement("button",{className:u,onClick:function(){return d.moveInDirection(l.id,"right")}},"\u27a1\ufe0f"),o.a.createElement("button",{className:u,onClick:function(){return d.moveInDirection(l.id,"up")}},"\u2b06"),o.a.createElement("button",{className:u,onClick:function(){return d.moveInDirection(l.id,"down")}},"\u2b07"),o.a.createElement("button",{className:u,onClick:function(){return d.onChange(function(e,t){if(!t)return e;var n=e.byId,r=n[t];if(!r)return e;var o=r.parentId,a=o?n[o]:void 0;return a&&o?R(e,t,o,{afterItemId:a.childrenIds[a.childrenIds.length-1]}):e}(d.value,d.value.focusedNodeId))}},"FlipToFront"),o.a.createElement("button",{"aria-label":"copy",className:u,onClick:function(){return d.copyFocused()}},"Copy"),o.a.createElement("button",{"aria-label":"paste",className:u,onClick:function(){return d.paste()}},"Paste"),o.a.createElement("button",{"aria-label":"delete",onClick:d.removeFocused},"\ud83d\uddd1"),o.a.createElement("div",null,o.a.createElement(_,Object(h.a)({onSelect:function(e){return c(e,!0)},byId:a,node:l},n))),o.a.createElement("div",{style:{paddingBottom:20}},[{prop:"width",numeric:!0},{prop:"height",numeric:!0},{prop:"top",numeric:!0},{prop:"left",numeric:!0},{prop:"borderWidth",numeric:!0},{prop:"borderTopWidth",numeric:!0},{prop:"borderBottomWidth",numeric:!0},{prop:"borderLeftWidth",numeric:!0},{prop:"borderRightWidth",numeric:!0},{prop:"borderStyle",numeric:!1}].map(function(e){return o.a.createElement("div",{key:e.prop,style:{display:"inline-block",marginRight:10},className:"form-group"},o.a.createElement("label",{style:{marginRight:5},htmlFor:e.prop,className:"form-label"},e.prop),o.a.createElement("input",{name:e.prop,className:"form-control",key:"prop_"+e.prop,value:void 0===l[e.prop]?"":l[e.prop],onChange:(t=l.id,n=e.prop,r=e.numeric,function(e){var o;d.updateBlock(t,((o={})[n]=r?e.target.value?parseInt(e.target.value,10):void 0:e.target.value,o))}),type:e.numeric?"numeric":void 0}));var t,n,r}))))},t}(o.a.Component),re=function(e){return o.a.createElement("button",{style:{borderWidth:1,fontSize:11,borderStyle:"solid",justifyContent:"flex-start"},onClick:e.onClick},o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{style:{borderWidth:1,borderRadius:3,borderStyle:"solid",width:20,height:20,backgroundColor:e.color||void 0}}),"\xa0",e.color?"":"none"))},oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.addRow=function(e){var n=ee(t.props.value,e),r=n.error,o=n.value;r?alert(r):t.props.onChange(o)},t.addCol=function(e){var n=te(t.props.value,e),r=n.error,o=n.value;r?alert(r):t.props.onChange(o)},t.addMarkDown=function(e){var n=function(e,t){var n=e.byId,r=e.rootNodeId,o=e.focusedNodeId,a=(t?t.parentId:o)||r,i=n[a],d=["row","col","layer"];if(!i||d.indexOf(i.type)<0)return{error:"Can only add markdown text inside "+d.join(", "),value:e};var l=B(n,"markdown"),c=Object(h.a)({type:"markdown",width:Math.max(1,i.width-20),height:Math.max(1,i.height-20)},t,{id:l,name:l,childrenIds:[]});return{createdBlock:c,value:Object(h.a)({},e,{byId:O(n,c,a),focusedNodeId:c.id})}}(t.props.value,e),r=n.error,o=n.value;r?alert(r):t.props.onChange(o)},t.addImage=function(e){var n=function(e,t){var n=t&&t.value?t.value:window.prompt("Please enter image url","http://lorempixel.com/200/200/");if(null===n)return{error:"no image selected",value:e};var r=e.byId,o=e.rootNodeId,a=e.focusedNodeId,i=(t?t.parentId:a)||o,d=r[i],l=["row","col","layer"];if(!d||l.indexOf(d.type)<0)return{error:"Can only add an image inside "+l.join(", "),value:e};var c=B(r,"image"),u=Object(h.a)({type:"image",value:n,width:200,height:200},t,{id:c,name:c,childrenIds:[]});return{createdBlock:u,value:Object(h.a)({},e,{byId:O(r,u,i),focusedNodeId:u.id})}}(t.props.value,e),r=n.error,o=n.value;r?alert(r):t.props.onChange(o)},t.addLayer=function(e){var n=function(e,t){var n=e.byId,r=e.rootNodeId,o=e.focusedNodeId,a=(t?t.parentId:o)||r,i=n[a],d=["row","col","layer"];if(!i||d.indexOf(i.type)<0)return{error:"Can only add a layer inside "+d.join(", "),value:e};var l=B(n,"layer"),c=Object(h.a)({type:"layer",width:Math.max(1,i.width*$),height:Math.max(1,i.height*$),paddingLeftPercentWidth:(1-$)/2,paddingTopPercentHeight:(1-$)/2},t,{id:l,name:l,childrenIds:[]});return{createdBlock:c,value:Object(h.a)({},e,{byId:O(n,c,a),focusedNodeId:c.id})}}(t.props.value,e),r=n.error,o=n.value;r?alert(r):t.props.onChange(o)},t.removeFocused=function(){var e=t.props.value.focusedNodeId;e&&t.destroy(e)},t.focusNode=function(e,n){void 0===n&&(n=!0);var r=t.props.value;t.props.onChange(P(r,e,n))},t.create=function(e){t.props.onChange(function(e,t){var n=e.byId,r=B(n),o=Object(h.a)({},n[r],t);return o?Object(h.a)({},e,{byId:w(n,o)}):e}(t.props.value,e))},t.updateBlock=function(e,n){t.props.onChange(x(t.props.value,e,n))},t.destroy=function(e){t.props.onChange(function(e,t){var n=e.byId,r=e.rootNodeId,o=e.focusedNodeId;return r===t?(alert("Cannot destroy root node"),Object(h.a)({},e,{byId:n,focusedNodeId:o})):Object(h.a)({},e,{byId:E(n,t),focusedNodeId:o===t?null:o})}(t.props.value,e))},t.move=function(e,n,r){void 0===r&&(r={}),t.props.onChange(R(t.props.value,e,n,r))},t.moveInDirection=function(e,n){t.props.onChange(function(e,t,n){void 0===n&&(n={});var r=e.byId,o=r[t];if(!o)return e;var a=o.parentId;if(!a)return e;var i=r[a];if(!i||!i.parentId)return e;var d=r[i.parentId],l=i.childrenIds.indexOf(t);if(l<0)return e;var c={};if("row"===i.type)if("left"===n.direction){if(0===l)return e;c={beforeItemId:i.childrenIds[l-1]}}else{if("right"!==n.direction){if(d&&"col"===d.type){var u=d.childrenIds.indexOf(i.id);return u>0&&"up"===n.direction?R(e,t,d.childrenIds[u-1]):u<d.childrenIds.length-1&&"down"===n.direction?R(e,t,d.childrenIds[u+1]):e}return e}if(l>=i.childrenIds.length-1)return e;c={afterItemId:i.childrenIds[l+1]}}else if("col"===i.type)if("up"===n.direction){if(0===l)return e;c={beforeItemId:i.childrenIds[l-1]}}else{if("down"!==n.direction)return d&&"row"===d.type?(u=d.childrenIds.indexOf(i.id))>0&&"left"===n.direction?R(e,t,d.childrenIds[u-1]):u<d.childrenIds.length-1&&"right"===n.direction?R(e,t,d.childrenIds[u+1]):e:e;if(l>=i.childrenIds.length-1)return e;c={afterItemId:i.childrenIds[l+1]}}else if("layer"===i.type){var s=("up"===n.direction?-1:"down"===n.direction?1:0)*(n.stepPx||1),p=("left"===n.direction?-1:"right"===n.direction?1:0)*(n.stepPx||1);c={absolutePos:{top:(o.top||0)+s,left:(o.left||0)+p}}}return Object(h.a)({},e,{byId:O(r,Object(h.a)({},o,{isPlaceHolder:c.isPlaceHolder},c.absolutePos?{top:c.absolutePos.top,left:c.absolutePos.left}:{}),a,c)})}(t.props.value,e,{direction:n}))},t.copyFocused=function(){var e=t.props.value,n=e.byId,r=e.focusedNodeId;if(r){var o=n[r];o&&t.props.onChange(Object(h.a)({},t.props.value,{copiedNode:N(n,o)}))}},t.paste=function(){t.props.onChange(A(t.props.value))},t.undo=function(){var e=t.props.value,n=e.byId,r=e.undoStack,o=e.redoStack;if(r.length>0){var a=r[0],i=[n].concat(o),d=r.slice(1),l=t.props.value.undoRedoVersion;t.props.onChange(Object(h.a)({},t.props.value,{undoRedoVersion:l+1,byId:a,undoStack:d,redoStack:i}))}},t.redo=function(){var e=t.props.value,n=e.byId,r=e.undoStack,o=e.redoStack;if(o.length>0){var a=o[0],i=[n].concat(r),d=o.slice(1),l=t.props.value.undoRedoVersion;t.props.onChange(Object(h.a)({},t.props.value,{undoRedoVersion:l+1,byId:a,undoStack:i,redoStack:d}))}},t}return Object(h.b)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.UiComponent,o=t.onChange,a=t.value,i=t.controlUiProps;return Object(r.createElement)(n,Object(h.a)({value:a,onChange:o,addRow:this.addRow,addCol:this.addCol,addImage:this.addImage,addLayer:this.addLayer,addMarkDown:this.addMarkDown,moveInDirection:this.moveInDirection,copyFocused:this.copyFocused,paste:this.paste,focusNode:function(t,n){var r=a.byId[t];r&&e.focusNode(r,n)},removeFocused:this.removeFocused,updateBlock:this.updateBlock,undo:this.undo,redo:this.redo},i))},t.defaultProps={UiComponent:ne},t}(r.Component),ae=(n(283),n(284),n(834),n(833),n(173)),ie=n(119),de=n(823),le=n(335),ce=n.n(le),ue=n(330),se=n.n(ue),he=n(334),pe=n.n(he),fe=n(331),me=n.n(fe),ge=n(332),be=n.n(ge),ve=n(333),Ie=n.n(ve),ye=n(837),Ce=n(829),ke=n(326),we=n.n(ke),Ee=n(327),Oe=Object(de.a)(function(e){return{button:{margin:e.spacing(1)},fab:{margin:e.spacing(1)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:60},input:{display:"none"}}}),je=function(e){var t=e.breadCrumbsProps,n=e.value,a=n.byId,i=n.focusedNodeId,l=i?a[i]:null,c=Object(r.useState)(null),s=Object(d.a)(c,2),h=s[0],p=s[1],f=Object(r.useState)(l&&l.color||void 0),m=Object(d.a)(f,2),g=m[0],b=m[1],v=Oe(),I=function(e){p(h===e?null:e)},y=function(t){return i&&l?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ne,{onClick:function(){return I(t)},color:l[t]||""}),h===t&&o.a.createElement("div",{style:{position:"absolute",zIndex:100,backgroundColor:"white"}},o.a.createElement(u.a,{size:"small",color:"secondary",onClick:function(){e.updateBlock(i,Object(ie.a)({},t,void 0)),I(t)}},"Clear"),o.a.createElement(u.a,{size:"small",color:"primary",onClick:function(){I(t),e.updateBlock(i,Object(ie.a)({},t,g))}},"Done"),o.a.createElement(Ee.SketchPicker,{color:g,onChangeComplete:function(e){var t=e.hex;b(t)}}))):null},C=i?a[i]:null,k=e.focusNode,w=v.button;return o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement(ye.a,{title:"Add Row (position children horizontally)","aria-label":"Add"},o.a.createElement(u.a,{"aria-label":"add row",className:w,onClick:function(){return e.addRow()}},"+ Row")),o.a.createElement(ye.a,{title:"Add Col (position children vertically)","aria-label":"Add"},o.a.createElement(u.a,{"aria-label":"add column",className:w,onClick:function(){return e.addCol()}},"+ Col")),o.a.createElement(ye.a,{title:"Add Layer (position children absolutely)","aria-label":"Add"},o.a.createElement(u.a,{"aria-label":"add layer",className:w,onClick:function(){return e.addLayer()}},"+ Layer")),o.a.createElement(ye.a,{title:"Add Text (markdown)","aria-label":"Add"},o.a.createElement(u.a,{"aria-label":"add markdown",className:w,onClick:function(){return e.addMarkDown()}},"+ Text")),o.a.createElement(u.a,{"aria-label":"add image",className:w,onClick:function(){return e.addImage()}},"+ Image"),o.a.createElement(u.a,{"aria-label":"add image",className:w,onClick:function(){e.onChange(function(e,t){if(!t)return alert("Please select node to add table to"),e;var n=window.prompt("Enter number or rows (max 10)","5");if(null===n)return e;var r=window.prompt("Enter number or columns (max 10)","5");if(null===r)return e;var o=window.prompt("Enter table width (max 400)","300");if(null===o)return e;var a=window.prompt("Enter table height (max 400)","300");if(null===a)return e;var i=Math.min(parseInt(o,10),400),d=Math.min(parseInt(a,10),400),l=te(e,{width:i,height:d,parentId:t}),c=l.value,u=l.createdBlock;if(!u)return e;e=c;for(var s=u.id,h=Math.max(1,Math.min(parseInt(n,10),10)),p=Math.max(1,Math.min(parseInt(r,10),10)),f=0;f<h;++f){var m=ee(e,{height:d/h,parentId:s}),g=m.value,b=m.createdBlock;if(!b)break;e=g;for(var v=0;v<p;++v){var I=te(e,{parentId:b.id,height:b.height,width:b.width/p}),y=I.value,C=I.createdBlock;if(!C)break;e=y}}return e}(e.value,e.value.focusedNodeId))}},"+ Table"),o.a.createElement(u.a,{"aria-label":"add image",className:w,onClick:function(){e.onChange(function(e,t){var n=e.byId,r=t?n[t]:null;if(!t||!r)return alert("Please select node to add input to"),e;var o=B(n,"input"),a={type:"custom",customType:"input",height:40,width:100,id:o,name:o,childrenIds:[]};return Object(ae.a)({},e,{byId:O(n,a,t),focusedNodeId:e.focusedNodeId||a.id})}(e.value,e.value.focusedNodeId))}},"+ Input"),o.a.createElement(u.a,{"aria-label":"undo",className:w,onClick:e.undo},"Undo"),o.a.createElement(u.a,{"aria-label":"redo",className:w,onClick:e.redo},"Redo")),C&&o.a.createElement("div",{style:{paddingLeft:15}},y("color"),y("backgroundColor"),o.a.createElement(u.a,{className:w,onClick:function(){return e.moveInDirection(C.id,"left")}},o.a.createElement(se.a,null)),o.a.createElement(u.a,{className:w,onClick:function(){return e.moveInDirection(C.id,"right")}},o.a.createElement(me.a,null)),o.a.createElement(u.a,{className:w,onClick:function(){return e.moveInDirection(C.id,"up")}},o.a.createElement(be.a,null)),o.a.createElement(u.a,{className:w,onClick:function(){return e.moveInDirection(C.id,"down")}},o.a.createElement(Ie.a,null)),o.a.createElement(ye.a,{title:"Flip to front","aria-label":"Add"},o.a.createElement(u.a,{className:w,onClick:function(){return e.onChange(function(e,t){if(!t)return e;var n=e.byId,r=n[t];if(!r)return e;var o=r.parentId,a=o?n[o]:void 0;return a&&o?R(e,t,o,{afterItemId:a.childrenIds[a.childrenIds.length-1]}):e}(e.value,e.value.focusedNodeId))}},o.a.createElement(pe.a,null))),o.a.createElement(u.a,{"aria-label":"copy",className:w,onClick:function(){return e.copyFocused()}},"Copy"),o.a.createElement(u.a,{"aria-label":"paste",className:w,onClick:function(){return e.paste()}},"Paste"),o.a.createElement(u.a,{"aria-label":"delete",className:v.fab,onClick:e.removeFocused},o.a.createElement(ce.a,null)),o.a.createElement(ye.a,{title:"Click breadcrumb to change focused block","aria-label":"Add"},o.a.createElement(u.a,null,o.a.createElement(_,Object.assign({onSelect:function(e){return k(e,!0)},byId:a,node:C},t)))),o.a.createElement("div",{style:{paddingBottom:5}},[{prop:"width",numeric:!0},{prop:"height",numeric:!0},{prop:"top",numeric:!0},{prop:"left",numeric:!0},{prop:"borderWidth",numeric:!0},{prop:"borderTopWidth",label:"bTopW",numeric:!0},{prop:"borderBottomWidth",label:"bBottomW",numeric:!0},{prop:"borderLeftWidth",label:"bLeftW",numeric:!0},{prop:"borderRightWidth",label:"bRightW",numeric:!0},{prop:"borderStyle",numeric:!1}].map(function(t){return o.a.createElement(Ce.a,{key:"prop_"+t.prop,label:t.label||t.prop,value:void 0===C[t.prop]?"":C[t.prop],onChange:(n=C.id,r=t.prop,a=t.numeric,function(t){e.updateBlock(n,Object(ie.a)({},r,a?t.target.value?parseInt(t.target.value,10):void 0:t.target.value))}),type:t.numeric?"number":void 0,className:v.textField,InputLabelProps:{shrink:!0},margin:"normal"});var n,r,a}))))},Ne=function(e){return o.a.createElement("div",{onClick:e.onClick,style:{display:"inline-block",marginTop:10,marginRight:10,borderWidth:1,borderRadius:3,borderStyle:"solid",width:20,height:20,backgroundColor:e.color||void 0}},void 0===e.color&&o.a.createElement("img",{alt:"transparent-color",style:{width:20,height:20},src:we.a}))};function Ae(e){var t=e.node,n=e.renderEditBlock,r=e.getNode,a=e.undoRedoVersion,i=e.changeBlocks,d=e.focusedNodeId;switch(t.type){case"custom":return function(e){switch(e.node.customType){case"input":return o.a.createElement(xe,{undoRedoVersion:e.undoRedoVersion,node:e.node,renderEditBlock:e.renderEditBlock,changeBlocks:e.changeBlocks,getNode:e.getNode,focusedNodeId:e.focusedNodeId});default:return o.a.createElement("div",null,"Unknown custom type ",e.node.customType)}}({node:t,undoRedoVersion:a,renderEditBlock:n,getNode:r,changeBlocks:i,focusedNodeId:d});default:return F({node:t,undoRedoVersion:a,renderEditBlock:n,getNode:r,changeBlocks:i,focusedNodeId:d})}}function Be(e){var t=e.node,n=e.byId,r=e.renderPreviewBlock;switch(t.type){case"custom":return function(e){switch(e.node.customType){case"input":return o.a.createElement(Re,{key:e.node.id,node:e.node,renderPreviewBlock:e.renderPreviewBlock,byId:e.byId});default:return o.a.createElement("div",null,"Unknown custom type ",e.node.customType)}}({node:t,renderPreviewBlock:r,byId:n});default:return K({byId:n,renderPreviewBlock:r,node:t})}}var xe=function(e){var t=Object(r.useRef)(null),n=function(){return t&&t.current&&t.current.getBoundingClientRect?t.current.getBoundingClientRect():null};return o.a.createElement("div",{ref:t,draggable:!0,onDragStart:function(t){return function(e,t,n){e.stopPropagation();var r=function(e,t){return t?{left:e.clientX-t.left,top:e.clientY-t.top,width:t.width,height:t.height}:null}(e,n());r&&e.dataTransfer.setData("text/plain",JSON.stringify({startLeft:r.left,startTop:r.top})),e.dataTransfer.setData("draggednodeid:"+t.id,""),e.dataTransfer.setData("draggednodetype:"+t.type,"")}(t,e.node,n)},onClick:function(t){t.stopPropagation(),e.changeBlocks(function(t){return P(t,e.node,!0)})},style:Object(ae.a)({display:"flex",flexDirection:"column",justifyContent:"center",backgroundColor:"lightpink",width:e.node.width,height:e.node.height},e.focusedNodeId===e.node.id?{borderStyle:"dashed",borderWidth:1,borderColor:"orange"}:{})},o.a.createElement("input",{onChange:function(t){e.changeBlocks(function(n){return x(n,e.node.id,{value:t.target.value})})},placeholder:"edit placeholder",value:e.node.value||""}))},Re=function(e){return o.a.createElement("input",{style:{width:e.node.width,height:e.node.height},placeholder:e.node.value})},Pe=Object(l.a)(function(e){return{paper:{backgroundColor:"white",position:"absolute",top:"20%",left:"20%",width:"60%",padding:20},breadcrumbNav:{display:"flex",listStyleType:"none",backgroundColor:"#f5f5f5",padding:10,flexDirection:"row"},breadcrumbItem:{cursor:"pointer","&::before":{content:'"  /  "'},marginRight:5}}});var Se=function(){var e=Pe(),t=Object(r.useState)({copiedNode:null,focusedNodeId:null,undoRedoVersion:1,undoStack:[],redoStack:[],byId:{container1:{id:"container1",type:"col",name:"container1",paddingLeftPercentWidth:.025,paddingTopPercentHeight:.025,parentId:void 0,width:560,height:360,childrenIds:["layer1"]},layer1:{id:"layer1",type:"layer",name:"layer1",parentId:"container1",width:510,height:330,childrenIds:["content","image1","row1"]},input1:{id:"input1",type:"custom",customType:"input",name:"input1",value:"First Name",parentId:"row1",width:100,height:40,childrenIds:[]},input2:{id:"input2",type:"custom",customType:"input",name:"input2",parentId:"row1",value:"Last Name",width:100,height:40,childrenIds:[]},image1:{id:"image1",type:"image",name:"image1",parentId:"layer1",width:200,height:200,top:0,left:250,value:"http://lorempixel.com/200/200/",childrenIds:[]},content:{id:"content",type:"markdown",name:"content",parentId:"layer1",width:200,height:200,top:0,left:16,value:"### Content \n> QUOTE\n> \n> GOES\n> \n> HERE",childrenIds:[]},row1:{id:"row1",type:"row",name:"row1",parentId:"layer1",width:210,height:60,top:230,left:250,childrenIds:["input1","input2"]}},rootNodeId:"container1"}),n=Object(d.a)(t,2),a=n[0],i=n[1],l=Object(r.useState)(!1),h=Object(d.a)(l,2),p=h[0],f=h[1],m=Object(r.useState)(!1),g=Object(d.a)(m,2),b=g[0],v=g[1],I=Object(r.useState)(""),y=Object(d.a)(I,2),C=y[0],k=y[1],w=Object(r.useState)(""),E=Object(d.a)(w,2),O=(E[0],E[1],function(){try{i(JSON.parse(C)),f(!1)}catch(e){console.error("Error loading from json",e),alert("Error loading from json: "+e)}}),j=a.byId[a.rootNodeId];return j?o.a.createElement("div",null,o.a.createElement(u.a,{onClick:function(){return f(!0)}},"Load from json"),o.a.createElement(u.a,{onClick:function(){return v(!0)}},"View json"),o.a.createElement(oe,{value:a,onChange:function(e){return console.log("VAL",e)||i(e)},UiComponent:je,controlUiProps:{breadCrumbsProps:{navClassName:e.breadcrumbNav,itemClassName:e.breadcrumbItem}}}),o.a.createElement(c.a,{container:!0,spacing:3},o.a.createElement(c.a,{item:!0,md:6},o.a.createElement("div",{style:{marginLeft:10}},o.a.createElement(Y,{renderEditBlock:Ae,value:a,onChange:i}))),o.a.createElement(c.a,{item:!0,md:6},o.a.createElement("div",{style:{marginRight:10,borderWidth:1,borderStyle:"dashed"}},o.a.createElement(q,{byId:a.byId,renderPreviewBlock:Be,node:j})))),o.a.createElement(s.a,{"aria-labelledby":"view-json","aria-describedby":"view-json",open:b,onClose:function(){return v(!1)}},o.a.createElement("div",{className:e.paper},o.a.createElement(u.a,{onClick:function(){return v(!1)}},"Done"),o.a.createElement("div",null,"json:"),o.a.createElement("div",null,JSON.stringify(a)))),o.a.createElement(s.a,{"aria-labelledby":"load-from-json","aria-describedby":"load-from-json",open:p,onClose:O},o.a.createElement("div",{className:e.paper},o.a.createElement(u.a,{onClick:O},"Load"),o.a.createElement(u.a,{onClick:function(){return f(!1)}},"Cancel"),o.a.createElement("div",null,"json:"),o.a.createElement("br",null),o.a.createElement("textarea",{style:{height:200,width:"100%"},value:C,onChange:function(e){return k(e.target.value)}},JSON.stringify(a,null,2))))):o.a.createElement("div",null,"Error: no root node (id=",a.rootNodeId,")")};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(Se,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[346,1,2]]]);
//# sourceMappingURL=main.d624cf56.chunk.js.map